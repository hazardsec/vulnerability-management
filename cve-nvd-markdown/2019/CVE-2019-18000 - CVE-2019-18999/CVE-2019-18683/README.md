# CVE-2019-18683


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2019-11-04 | 2022-04-18 | cve@mitre.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | An issue was discovered in drivers/media/platform/vivid in the Linux kernel through 5.3.8. It is exploitable for privilege escalation on some Linux distributions where local users have /dev/video0 access, but only if the driver happens to be loaded. There are multiple race conditions during streaming stopping in this driver (part of the V4L2 subsystem). These issues are caused by wrong mutex locking in vivid_stop_generating_vid_cap(), vivid_stop_generating_vid_out(), sdr_cap_stop_streaming(), and the corresponding kthreads. At least one of these race conditions leads to a use-after-free. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:* | []  5.3.8   | OR |
| True  cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:* | []     | OR |
| True  cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:esm:*:*:* | []     | OR |
| True  cpe:2.3:o:canonical:ubuntu_linux:19.10:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:esm:*:*:* | []     | OR |
| True  cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:cloud_backup:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:element_software:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:steelstore_cloud_integrated_storage:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:data_availability_services:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:solidfire:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:hci_management_node:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:active_iq_unified_manager:-:*:*:*:*:vmware_vsphere:*:* | []     | OR |
| True  cpe:2.3:a:netapp:e-series_santricity_os_controller:*:*:*:*:*:*:*:* | [] | 11.0.0 | 11.70.1   | OR |
| True  cpe:2.3:o:broadcom:fabric_operating_system:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.0 | HIGH | 5.9 | 1.0 | CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H | 3.1 | LOCAL | HIGH | LOW | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 6.9 | MEDIUM | 10.0 | 3.4 | AV:L/AC:M/Au:N/C:C/I:C/A:C | 2.0 | LOCAL | MEDIUM | NONE | False | False | False | False | COMPLETE | COMPLETE | COMPLETE |

## Problem Type
CWE-362
CWE-416

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://www.openwall.com/lists/oss-security/2019/11/02/1|https://www.openwall.com/lists/oss-security/2019/11/02/1|MISC|['Exploit', 'Mailing List', 'Third Party Advisory']
https://lore.kernel.org/lkml/20191103221719.27118-1-alex.popov@linux.com/|https://lore.kernel.org/lkml/20191103221719.27118-1-alex.popov@linux.com/|MISC|['Patch', 'Vendor Advisory']
[oss-security] 20191105 Re: [ Linux kernel ] Exploitable bugs in drivers/media/platform/vivid|http://www.openwall.com/lists/oss-security/2019/11/05/1|MLIST|['Exploit', 'Mailing List', 'Third Party Advisory']
https://security.netapp.com/advisory/ntap-20191205-0001/|https://security.netapp.com/advisory/ntap-20191205-0001/|CONFIRM|['Third Party Advisory']
openSUSE-SU-2019:2675|http://lists.opensuse.org/opensuse-security-announce/2019-12/msg00029.html|SUSE|['Mailing List', 'Third Party Advisory']
20200109 [slackware-security] Slackware 14.2 kernel (SSA:2020-008-01)|https://seclists.org/bugtraq/2020/Jan/10|BUGTRAQ|['Mailing List', 'Patch', 'Third Party Advisory']
http://packetstormsecurity.com/files/155890/Slackware-Security-Advisory-Slackware-14.2-kernel-Updates.html|http://packetstormsecurity.com/files/155890/Slackware-Security-Advisory-Slackware-14.2-kernel-Updates.html|MISC|['Third Party Advisory', 'VDB Entry']
USN-4254-1|https://usn.ubuntu.com/4254-1/|UBUNTU|['Third Party Advisory']
USN-4254-2|https://usn.ubuntu.com/4254-2/|UBUNTU|['Third Party Advisory']
USN-4258-1|https://usn.ubuntu.com/4258-1/|UBUNTU|['Third Party Advisory']
USN-4287-1|https://usn.ubuntu.com/4287-1/|UBUNTU|['Third Party Advisory']
USN-4287-2|https://usn.ubuntu.com/4287-2/|UBUNTU|['Third Party Advisory']
[debian-lts-announce] 20200302 [SECURITY] [DLA 2114-1] linux-4.9 security update|https://lists.debian.org/debian-lts-announce/2020/03/msg00001.html|MLIST|['Mailing List', 'Third Party Advisory']
USN-4284-1|https://usn.ubuntu.com/4284-1/|UBUNTU|['Third Party Advisory']
