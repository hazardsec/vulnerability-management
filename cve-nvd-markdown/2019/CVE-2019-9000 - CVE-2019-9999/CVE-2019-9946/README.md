# CVE-2019-9946


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2019-04-02 18:30:00 | 2020-08-24 17:37:00 | cve@mitre.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Cloud Native Computing Foundation (CNCF) CNI (Container Networking Interface) 0.7.4 has a network firewall misconfiguration which affects Kubernetes. The CNI 'portmap' plugin, used to setup HostPorts for CNI, inserts rules at the front of the iptables nat chains; which take precedence over the KUBE- SERVICES chain. Because of this, the HostPort/portmap rule could match incoming traffic even if there were better fitting, more specific service definition rules like NodePorts later in the chain. The issue is fixed in CNI 0.7.5 and Kubernetes 1.11.9, 1.12.7, 1.13.5, and 1.14.0. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:kubernetes:kubernetes:1.13.6:beta0:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:kubernetes:kubernetes:1.14.0:alpha0:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:kubernetes:kubernetes:1.14.0:alpha1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:kubernetes:kubernetes:1.14.0:alpha2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:kubernetes:kubernetes:1.14.0:alpha3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:kubernetes:kubernetes:1.14.0:beta0:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:cncf:portmap:*:*:*:*:*:container_networking_interface:*:* | [] | OR |
| True | cpe:2.3:a:kubernetes:kubernetes:1.14.0:beta1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:kubernetes:kubernetes:1.14.0:beta2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:kubernetes:kubernetes:1.14.0:rc1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:netapp:cloud_insights:-:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.5 | HIGH | 3.6 | 3.9 | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N | 3.0 | NETWORK | LOW | NONE | NONE | UNCHANGED | NONE | HIGH | NONE |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 5.0 | MEDIUM | 2.9 | 10.0 | AV:N/AC:L/Au:N/C:N/I:P/A:N | 2.0 | NETWORK | LOW | NONE | 0 | False | False | False | NONE | PARTIAL | NONE |

## Problem Type
CWE-670

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/containernetworking/plugins/pull/269#issuecomment-477683272|https://github.com/containernetworking/plugins/pull/269#issuecomment-477683272|CONFIRM|['Patch', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://security.netapp.com/advisory/ntap-20190416-0002/|https://security.netapp.com/advisory/ntap-20190416-0002/|CONFIRM|['Patch', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
RHBA-2019:0862|https://access.redhat.com/errata/RHBA-2019:0862|REDHAT|[]
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
FEDORA-2019-d2b57d3b19|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FCN66VYB3XS76SYH567SO7N3I254JOCT/|FEDORA|[]
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
FEDORA-2019-24217abfdf|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/SGOOWAELGH3F7OXRBPH3HCNZELNLXYTW/|FEDORA|[]
