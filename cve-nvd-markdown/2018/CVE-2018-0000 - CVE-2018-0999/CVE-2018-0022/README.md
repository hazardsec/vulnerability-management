# CVE-2018-0022


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2018-04-11 19:29:00 | 2019-10-09 23:30:00 | sirt@juniper.net | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | A Junos device with VPLS routing-instances configured on one or more interfaces may be susceptible to an mbuf leak when processing a specific MPLS packet. Approximately 1 mbuf is leaked per each packet processed. The number of mbufs is platform dependent. The following command provides the number of mbufs that are currently in use and maximum number of mbufs that can be allocated on a platform: > show system buffers 2437/3143/5580 mbufs in use (current/cache/total) Once the device runs out of mbufs it will become inaccessible and a restart will be required. This issue only affects end devices, transit devices are not affected. Affected releases are Juniper Networks Junos OS with VPLS configured running: 12.1X46 versions prior to 12.1X46-D76; 12.3X48 versions prior to 12.3X48-D66, 12.3X48-D70; 14.1 versions prior to 14.1R9; 14.1X53 versions prior to 14.1X53-D47; 14.2 versions prior to 14.2R8; 15.1 versions prior to 15.1F2-S19, 15.1F6-S10, 15.1R4-S9, 15.1R5-S7, 15.1R6-S4, 15.1R7; 15.1X49 versions prior to 15.1X49-D131, 15.1X49-D140; 15.1X53 versions prior to 15.1X53-D58 on EX2300/EX3400; 15.1X53 versions prior to 15.1X53-D233 on QFX5200/QFX5110; 15.1X53 versions prior to 15.1X53-D471 on NFX; 15.1X53 versions prior to 15.1X53-D66 on QFX10; 16.1 versions prior to 16.1R3-S8, 16.1R4-S6, 16.1R5; 16.2 versions prior to 16.2R1-S6, 16.2R2-S5, 16.2R3; 17.1 versions prior to 17.1R1-S7, 17.1R2-S6, 17.1R3; 17.2 versions prior to 17.2R1-S5, 17.2R2. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:o:juniper:junos:15.1x49:d50:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d30:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d70:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d80:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d110:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d60:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d100:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d35:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d40:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d45:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d10:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d55:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d65:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d120:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d75:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d90:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d20:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1x49:d130:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1:r4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1:r8:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1:r7:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1:r6:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1:r5:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d45:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d15:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d35:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d40:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d30:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d42:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d25:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d27:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d16:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d43:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d26:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d44:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.1x53:d46:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:16.1:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:16.1:r4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:16.1:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:16.1:r5:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:16.1:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:16.2:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:16.2:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:16.2:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:17.1:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:17.1:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:17.1:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:r6:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:r4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d60:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d30:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d45:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d50:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d25:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d65:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d35:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d20:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d40:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d55:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d10:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.1x46:d15:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d10:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d15:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d35:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d50:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d30:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d25:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d45:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d55:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d40:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d20:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d65:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:12.3x48:d60:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.2:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.2:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.2:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.2:r6:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.2:r7:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.2:r4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:14.2:r5:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:f1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:f4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:f6:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:f2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:f3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:15.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:17.2:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:17.2:r2:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.5 | HIGH | 3.6 | 3.9 | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H | 3.0 | NETWORK | LOW | NONE | NONE | UNCHANGED | NONE | NONE | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 7.8 | HIGH | 6.9 | 10.0 | AV:N/AC:L/Au:N/C:N/I:N/A:C | 2.0 | NETWORK | LOW | NONE | 0 | False | False | False | NONE | NONE | COMPLETE |

## Problem Type
CWE-400

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://kb.juniper.net/JSA10855|https://kb.juniper.net/JSA10855|CONFIRM|['Vendor Advisory']
103740|http://www.securityfocus.com/bid/103740|BID|['Third Party Advisory', 'VDB Entry']
1040790|http://www.securitytracker.com/id/1040790|SECTRACK|['Third Party Advisory', 'VDB Entry']
