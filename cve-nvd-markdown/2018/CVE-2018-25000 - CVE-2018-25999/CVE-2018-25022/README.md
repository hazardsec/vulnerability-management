# CVE-2018-25022


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-12-13 01:15:00 | 2022-02-08 18:55:00 | cve@mitre.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | The Onion module in toxcore before 0.2.2 doesn't restrict which packets can be onion-routed, which allows a remote attacker to discover a target user's IP address (when knowing only their Tox Id) by positioning themselves close to target's Tox Id in the DHT for the target to establish an onion connection with the attacker, guessing the target's DHT public key and creating a DHT node with public key close to it, and finally onion-routing a NAT Ping Request to the target, requesting it to ping the just created DHT node. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:toktok:toxcore:*:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 3.1 | LOW | 1.4 | 1.6 | CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N | 3.1 | NETWORK | HIGH | LOW | NONE | UNCHANGED | LOW | NONE | NONE |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 4.3 | MEDIUM | 2.9 | 8.6 | AV:N/AC:M/Au:N/C:P/I:N/A:N | 2.0 | NETWORK | MEDIUM | NONE | 0 | False | False | False | PARTIAL | NONE | NONE |

## Problem Type
CWE-200

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/TokTok/c-toxcore/pull/872|https://github.com/TokTok/c-toxcore/pull/872|MISC|['Patch', 'Third Party Advisory']
https://github.com/TokTok/c-toxcore/issues/873|https://github.com/TokTok/c-toxcore/issues/873|MISC|['Exploit', 'Issue Tracking', 'Third Party Advisory']
https://blog.tox.chat/2018/04/security-vulnerability-and-new-toxcore-release|https://blog.tox.chat/2018/04/security-vulnerability-and-new-toxcore-release|MISC|['Exploit', 'Vendor Advisory']
