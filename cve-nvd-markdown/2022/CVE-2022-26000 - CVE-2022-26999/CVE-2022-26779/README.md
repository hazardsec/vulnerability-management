# CVE-2022-26779


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-03-15 | 2022-03-22 | security@apache.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Apache CloudStack prior to 4.16.1.0 used insecure random number generation for project invitation tokens. If a project invite is created based only on an email address, a random token is generated. An attacker with knowledge of the project ID and the fact that the invite is sent, could generate time deterministic tokens and brute force attempt to use them prior to the legitimate receiver accepting the invite. This feature is not enabled by default, the attacker is required to know or guess the project ID for the invite in addition to the invitation token, and the attacker would need to be an existing authorized user of CloudStack. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:apache:cloudstack:*:*:*:*:*:*:*:* | []    4.16.1.0 | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.5 | HIGH | 5.9 | 1.6 | CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H | 3.1 | NETWORK | HIGH | LOW | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 4.6 | MEDIUM | 6.4 | 3.9 | AV:N/AC:H/Au:S/C:P/I:P/A:P | 2.0 | NETWORK | HIGH | SINGLE | False | False | False | False | PARTIAL | PARTIAL | PARTIAL |

## Problem Type
CWE-338

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://lists.apache.org/thread/dmm07b1cyosovqr12ddhkko501p11h2h|https://lists.apache.org/thread/dmm07b1cyosovqr12ddhkko501p11h2h|MISC|['Mailing List', 'Vendor Advisory']
https://github.com/JLLeitschuh/security-research/security/advisories/GHSA-vpcc-9rh2-8jfp|https://github.com/JLLeitschuh/security-research/security/advisories/GHSA-vpcc-9rh2-8jfp|MISC|['Exploit', 'Patch', 'Third Party Advisory']
[oss-security] 20220315 CVE-2022-26779: Apache Cloudstack insecure random number generation affects project email invitation|http://www.openwall.com/lists/oss-security/2022/03/15/1|MLIST|['Mailing List', 'Third Party Advisory']
