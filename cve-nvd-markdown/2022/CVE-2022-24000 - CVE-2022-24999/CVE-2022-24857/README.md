# CVE-2022-24857


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-04-15 | 2022-06-09 | security-advisories@github.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | django-mfa3 is a library that implements multi factor authentication for the django web framework. It achieves this by modifying the regular login view. Django however has a second login view for its admin area. This second login view was not modified, so the multi factor authentication can be bypassed. Users are affected if they have activated both django-mfa3 (< 0.5.0) and django.contrib.admin and have not taken any other measures to prevent users from accessing the admin login view. The issue has been fixed in django-mfa3 0.5.0. It is possible to work around the issue by overwriting the admin login route, e.g. by adding the following URL definition *before* the admin routes: url('admin/login/', lambda request: redirect(settings.LOGIN_URL) |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:django-mfa3_project:django-mfa3:*:*:*:*:*:*:*:* | []    0.5.0 | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 8.8 | HIGH | 5.9 | 2.8 | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H | 3.1 | NETWORK | LOW | LOW | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 6.5 | MEDIUM | 6.4 | 8.0 | AV:N/AC:L/Au:S/C:P/I:P/A:P | 2.0 | NETWORK | LOW | SINGLE | False | False | False | False | PARTIAL | PARTIAL | PARTIAL |

## Problem Type
CWE-287

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/xi/django-mfa3/blob/main/CHANGES.md#050-2022-04-15|https://github.com/xi/django-mfa3/blob/main/CHANGES.md#050-2022-04-15|MISC|['Release Notes', 'Third Party Advisory']
https://github.com/xi/django-mfa3/commit/32f656e22df120b84bdf010e014bb19bd97971de|https://github.com/xi/django-mfa3/commit/32f656e22df120b84bdf010e014bb19bd97971de|MISC|['Patch', 'Third Party Advisory']
https://github.com/xi/django-mfa3/security/advisories/GHSA-3r7g-wrpr-j5g4|https://github.com/xi/django-mfa3/security/advisories/GHSA-3r7g-wrpr-j5g4|CONFIRM|['Third Party Advisory']
https://security.netapp.com/advisory/ntap-20220609-0003/|https://security.netapp.com/advisory/ntap-20220609-0003/|CONFIRM|[]
