# CVE-2022-39260


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-10-19 | 2022-11-16 | security-advisories@github.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Git is an open source, scalable, distributed revision control system. `git shell` is a restricted login shell that can be used to implement Git's push/pull functionality via SSH. In versions prior to 2.30.6, 2.31.5, 2.32.4, 2.33.5, 2.34.5, 2.35.5, 2.36.3, and 2.37.4, the function that splits the command arguments into an array improperly uses an `int` to represent the number of entries in the array, allowing a malicious actor to intentionally overflow the return value, leading to arbitrary heap writes. Because the resulting array is then passed to `execv()`, it is possible to leverage this attack to gain remote code execution on a victim machine. Note that a victim must first allow access to `git shell` as a login shell in order to be vulnerable to this attack. This problem is patched in versions 2.30.6, 2.31.5, 2.32.4, 2.33.5, 2.34.5, 2.35.5, 2.36.3, and 2.37.4 and users are advised to upgrade to the latest version. Disabling `git shell` access via remote logins is a viable short-term workaround. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:git-scm:git:2.38.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:git-scm:git:*:*:*:*:*:*:*:* | [] | 2.37.0   | 2.37.4 | OR |
| True  cpe:2.3:a:git-scm:git:*:*:*:*:*:*:*:* | [] | 2.36.0   | 2.36.3 | OR |
| True  cpe:2.3:a:git-scm:git:*:*:*:*:*:*:*:* | [] | 2.35.0   | 2.35.5 | OR |
| True  cpe:2.3:a:git-scm:git:*:*:*:*:*:*:*:* | [] | 2.34.0   | 2.34.5 | OR |
| True  cpe:2.3:a:git-scm:git:*:*:*:*:*:*:*:* | [] | 2.33.0   | 2.33.5 | OR |
| True  cpe:2.3:a:git-scm:git:*:*:*:*:*:*:*:* | [] | 2.32.0   | 2.32.4 | OR |
| True  cpe:2.3:a:git-scm:git:*:*:*:*:*:*:*:* | [] | 2.31.0   | 2.31.5 | OR |
| True  cpe:2.3:a:git-scm:git:*:*:*:*:*:*:*:* | []    2.30.6 | OR |
| True  cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:apple:xcode:*:*:*:*:*:*:*:* | []    14.1 | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 8.8 | HIGH | 5.9 | 2.8 | CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H | 3.1 | NETWORK | LOW | NONE | REQUIRED | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
*** Not Provided/Calculated ***

## Problem Type
CWE-787

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/git/git/security/advisories/GHSA-rjr6-wcq6-83p6|https://github.com/git/git/security/advisories/GHSA-rjr6-wcq6-83p6|CONFIRM|['Mitigation', 'Third Party Advisory']
FEDORA-2022-8b58806840|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/UKFHE4KVD7EKS5J3KTDFVBEKU3CLXGVV/|FEDORA|['Mailing List', 'Third Party Advisory']
https://support.apple.com/kb/HT213496|https://support.apple.com/kb/HT213496|CONFIRM|['Third Party Advisory']
FEDORA-2022-53aadd995f|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OHNO2FB55CPX47BAXMBWUBGWHO6N6ZZH/|FEDORA|['Mailing List', 'Third Party Advisory']
20221107 APPLE-SA-2022-11-01-1 Xcode 14.1|http://seclists.org/fulldisclosure/2022/Nov/1|FULLDISC|['Mailing List', 'Third Party Advisory']
FEDORA-2022-fb088df94c|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/C7B6JPKX5CGGLAHXJVQMIZNNEEB72FHD/|FEDORA|['Mailing List', 'Third Party Advisory']
