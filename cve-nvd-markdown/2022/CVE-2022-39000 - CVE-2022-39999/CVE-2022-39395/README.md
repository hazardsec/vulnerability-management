# CVE-2022-39395


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-11-10 | 2022-11-17 | security-advisories@github.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Vela is a Pipeline Automation (CI/CD) framework built on Linux container technology written in Golang. In Vela Server and Vela Worker prior to version 0.16.0 and Vela UI prior to version 0.17.0, some default configurations for Vela allow exploitation and container breakouts. Users should upgrade to Server 0.16.0, Worker 0.16.0, and UI 0.17.0 to fix the issue. After upgrading, Vela administrators will need to explicitly change the default settings to configure Vela as desired. Some of the fixes will interrupt existing workflows and will require Vela administrators to modify default settings. However, not applying the patch (or workarounds) will continue existing risk exposure. Some workarounds are available. Vela administrators can adjust the worker's `VELA_RUNTIME_PRIVILEGED_IMAGES` setting to be explicitly empty, leverage the `VELA_REPO_ALLOWLIST` setting on the server component to restrict access to a list of repositories that are allowed to be enabled, and/or audit enabled repositories and disable pull_requests if they are not needed. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:go-vela:ui:*:*:*:*:*:*:*:* | []    0.17.0 | OR |
| True  cpe:2.3:a:go-vela:worker:*:*:*:*:*:*:*:* | []    0.16.0 | OR |
| True  cpe:2.3:a:go-vela:server:*:*:*:*:*:*:*:* | []    0.16.0 | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 9.9 | CRITICAL | 6.0 | 3.1 | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H | 3.1 | NETWORK | LOW | LOW | NONE | CHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
*** Not Provided/Calculated ***

## Problem Type
CWE-269

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://go-vela.github.io/docs/installation/server/reference/#vela_repo_allowlist|https://go-vela.github.io/docs/installation/server/reference/#vela_repo_allowlist|MISC|['Vendor Advisory']
https://github.com/go-vela/worker/releases/tag/v0.16.0|https://github.com/go-vela/worker/releases/tag/v0.16.0|MISC|['Release Notes', 'Third Party Advisory']
https://github.com/go-vela/server/commit/05558ee99d70f7d6f83bed7c8f78ac0b35fa26f4|https://github.com/go-vela/server/commit/05558ee99d70f7d6f83bed7c8f78ac0b35fa26f4|MISC|['Patch', 'Third Party Advisory']
https://docs.docker.com/engine/security/#docker-daemon-attack-surface|https://docs.docker.com/engine/security/#docker-daemon-attack-surface|MISC|['Technical Description', 'Third Party Advisory']
https://github.com/go-vela/ui/releases/tag/v0.17.0|https://github.com/go-vela/ui/releases/tag/v0.17.0|MISC|['Release Notes', 'Third Party Advisory']
https://github.com/go-vela/server/security/advisories/GHSA-5m7g-pj8w-7593|https://github.com/go-vela/server/security/advisories/GHSA-5m7g-pj8w-7593|CONFIRM|['Third Party Advisory']
https://go-vela.github.io/docs/installation/worker/reference/#vela_runtime_privileged_images|https://go-vela.github.io/docs/installation/worker/reference/#vela_runtime_privileged_images|MISC|['Vendor Advisory']
https://github.com/go-vela/ui/security/advisories/GHSA-xf39-98m2-889v|https://github.com/go-vela/ui/security/advisories/GHSA-xf39-98m2-889v|MISC|['Third Party Advisory']
https://github.com/go-vela/worker/security/advisories/GHSA-2w78-ffv6-p46w|https://github.com/go-vela/worker/security/advisories/GHSA-2w78-ffv6-p46w|MISC|['Third Party Advisory']
https://github.com/go-vela/server/releases/tag/v0.16.0|https://github.com/go-vela/server/releases/tag/v0.16.0|MISC|['Release Notes', 'Third Party Advisory']
