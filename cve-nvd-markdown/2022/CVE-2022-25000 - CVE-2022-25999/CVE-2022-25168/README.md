# CVE-2022-25168


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-08-04 | 2022-10-28 | security@apache.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | "Apache Hadoop's FileUtil.unTar(File, File) API does not escape the input file name before being passed to the shell. An attacker can inject arbitrary commands. This is only used in Hadoop 3.3 InMemoryAliasMap.completeBootstrapTransfer, which is only ever run by a local user. It has been used in Hadoop 2.x for yarn localization, which does enable remote code execution. It is used in Apache Spark, from the SQL command ADD ARCHIVE. As the ADD ARCHIVE command adds new binaries to the classpath, being able to execute shell scripts does not confer new permissions to the caller. SPARK-38305. ""Check existence of file before untarring/zipping"", which is included in 3.3.0, 3.1.4, 3.2.2, prevents shell commands being executed, regardless of which version of the hadoop libraries are in use. Users should upgrade to Apache Hadoop 2.10.2, 3.2.4, 3.3.3 or upper (including HADOOP-18136)." |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:apache:hadoop:*:*:*:*:*:*:*:* | [] | 2.0.0 | 2.10.1   | OR |
| True  cpe:2.3:a:apache:hadoop:*:*:*:*:*:*:*:* | [] | 3.3.0 | 3.3.2   | OR |
| True  cpe:2.3:a:apache:hadoop:*:*:*:*:*:*:*:* | [] | 3.0.0 | 3.2.3   | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 9.8 | CRITICAL | 5.9 | 3.9 | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H | 3.1 | NETWORK | LOW | NONE | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
*** Not Provided/Calculated ***

## Problem Type
CWE-88

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://lists.apache.org/thread/mxqnb39jfrwgs3j6phwvlrfq4mlox130|https://lists.apache.org/thread/mxqnb39jfrwgs3j6phwvlrfq4mlox130|MISC|['Mailing List', 'Vendor Advisory']
https://security.netapp.com/advisory/ntap-20220915-0007/|https://security.netapp.com/advisory/ntap-20220915-0007/|CONFIRM|['Third Party Advisory']
