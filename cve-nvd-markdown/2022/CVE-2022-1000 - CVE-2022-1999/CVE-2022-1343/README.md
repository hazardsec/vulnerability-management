# CVE-2022-1343


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-05-03 | 2022-10-19 | openssl-security@openssl.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | "The function `OCSP_basic_verify` verifies the signer certificate on an OCSP response. In the case where the (non-default) flag OCSP_NOCHECKS is used then the response will be positive (meaning a successful verification) even in the case where the response signing certificate fails to verify. It is anticipated that most users of `OCSP_basic_verify` will not use the OCSP_NOCHECKS flag. In this case the `OCSP_basic_verify` function will return a negative value (indicating a fatal error) in the case of a certificate verification failure. The normal expected return value in this case would be 0. This issue also impacts the command line OpenSSL ""ocsp"" application. When verifying an ocsp response with the ""-no_cert_checks"" option the command line application will report that the verification is successful even though it has in fact failed. In this case the incorrect successful response will also be accompanied by error messages showing the failure and contradicting the apparently successful result. Fixed in OpenSSL 3.0.3 (Affected 3.0.0,3.0.1,3.0.2)." |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:openssl:openssl:*:*:*:*:*:*:*:* | [] | 3.0.0   | 3.0.3 | OR |
| True  cpe:2.3:a:netapp:santricity_smi-s_provider:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:clustered_data_ontap:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:smi-s_provider:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:clustered_data_ontap_antivirus_connector:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:solidfire_\&_hci_management_node:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:solidfire\,_enterprise_sds_\&_hci_storage_node:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:netapp:active_iq_unified_manager:-:*:*:*:*:vsphere:*:* | []     | OR |
| True  cpe:2.3:a:netapp:snapmanager:-:*:*:*:*:hyper-v:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 5.3 | MEDIUM | 1.4 | 3.9 | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N | 3.1 | NETWORK | LOW | NONE | NONE | UNCHANGED | NONE | LOW | NONE |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 4.3 | MEDIUM | 2.9 | 8.6 | AV:N/AC:M/Au:N/C:N/I:P/A:N | 2.0 | NETWORK | MEDIUM | NONE | False | False | False | False | NONE | PARTIAL | NONE |

## Problem Type
CWE-295

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=2eda98790c5c2741d76d23cc1e74b0dc4f4b391a|https://git.openssl.org/gitweb/?p=openssl.git;a=commitdiff;h=2eda98790c5c2741d76d23cc1e74b0dc4f4b391a|CONFIRM|['Mailing List', 'Patch', 'Vendor Advisory']
https://www.openssl.org/news/secadv/20220503.txt|https://www.openssl.org/news/secadv/20220503.txt|CONFIRM|['Vendor Advisory']
https://security.netapp.com/advisory/ntap-20220602-0009/|https://security.netapp.com/advisory/ntap-20220602-0009/|CONFIRM|['Third Party Advisory']
