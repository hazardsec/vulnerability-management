# CVE-2022-1941


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-09-22 | 2022-10-01 | security@google.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | A parsing vulnerability for the MessageSet type in the ProtocolBuffers versions prior to and including 3.16.1, 3.17.3, 3.18.2, 3.19.4, 3.20.1 and 3.21.5 for protobuf-cpp, and versions prior to and including 3.16.1, 3.17.3, 3.18.2, 3.19.4, 3.20.1 and 4.21.5 for protobuf-python can lead to out of memory failures. A specially crafted message with multiple key-value per elements creates parsing issues, and can lead to a Denial of Service against services receiving unsanitized input. We recommend upgrading to versions 3.18.3, 3.19.5, 3.20.2, 3.21.6 for protobuf-cpp and 3.18.3, 3.19.5, 3.20.2, 4.21.6 for protobuf-python. Versions for 3.16 and 3.17 are no longer updated. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:google:protobuf-cpp:*:*:*:*:*:*:*:* | [] | 3.21.0   | 3.21.6 | OR |
| True  cpe:2.3:a:google:protobuf-cpp:*:*:*:*:*:*:*:* | [] | 3.20.0   | 3.20.2 | OR |
| True  cpe:2.3:a:google:protobuf-cpp:*:*:*:*:*:*:*:* | [] | 3.19.0   | 3.19.5 | OR |
| True  cpe:2.3:a:google:protobuf-cpp:*:*:*:*:*:*:*:* | []    3.18.3 | OR |
| True  cpe:2.3:a:google:protobuf-python:*:*:*:*:*:*:*:* | [] | 4.0.0   | 4.21.6 | OR |
| True  cpe:2.3:a:google:protobuf-python:*:*:*:*:*:*:*:* | [] | 3.20.0   | 3.20.2 | OR |
| True  cpe:2.3:a:google:protobuf-python:*:*:*:*:*:*:*:* | [] | 3.19.0   | 3.19.5 | OR |
| True  cpe:2.3:a:google:protobuf-python:*:*:*:*:*:*:*:* | []    3.18.3 | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.5 | HIGH | 3.6 | 3.9 | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H | 3.1 | NETWORK | LOW | NONE | NONE | UNCHANGED | NONE | NONE | HIGH |

## CVSSv2 Information
*** Not Provided/Calculated ***

## Problem Type
CWE-119

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://cloud.google.com/support/bulletins#GCP-2022-019|https://cloud.google.com/support/bulletins#GCP-2022-019|CONFIRM|['Third Party Advisory']
https://github.com/protocolbuffers/protobuf/security/advisories/GHSA-8gq9-2x98-w8hf|https://github.com/protocolbuffers/protobuf/security/advisories/GHSA-8gq9-2x98-w8hf|CONFIRM|['Third Party Advisory']
[oss-security] 20220927 CVE-2022-1941: Protobuf C++, Python DoS|http://www.openwall.com/lists/oss-security/2022/09/27/1|MLIST|['Mailing List', 'Third Party Advisory']
