# CVE-2022-32230


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-06-14 22:15:00 | 2022-06-23 19:28:00 | cve@rapid7.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Microsoft Windows SMBv3 suffers from a null pointer dereference in versions of Windows prior to the April, 2022 patch set. By sending a malformed FileNormalizedNameInformation SMBv3 request over a named pipe, an attacker can cause a Blue Screen of Death (BSOD) crash of the Windows kernel. For most systems, this attack requires authentication, except in the special case of Windows Domain Controllers, where unauthenticated users can always open named pipes as long as they can establish an SMB session. Typically, after the BSOD, the victim SMBv3 server will reboot. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:o:microsoft:windows_server_2019:-:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_10:1809:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_10:20h2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_10:21h1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_11:-:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_10:21h2:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.5 | HIGH | 3.6 | 3.9 | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H | 3.1 | NETWORK | LOW | NONE | NONE | UNCHANGED | NONE | NONE | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 7.8 | HIGH | 6.9 | 10.0 | AV:N/AC:L/Au:N/C:N/I:N/A:C | 2.0 | NETWORK | LOW | NONE | 0 | False | False | False | NONE | NONE | COMPLETE |

## Problem Type
CWE-476

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-32230|https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-32230|CONFIRM|['Patch', 'Vendor Advisory']
https://www.rapid7.com/blog/post/2022/06/14/cve-2022-32230-windows-smb-denial-of-service-vulnerability-fixed/|https://www.rapid7.com/blog/post/2022/06/14/cve-2022-32230-windows-smb-denial-of-service-vulnerability-fixed/|MISC|['Exploit', 'Third Party Advisory']
https://support.microsoft.com/en-us/topic/may-10-2022-kb5013942-os-builds-19042-1706-19043-1706-and-19044-1706-60b51119-85be-4a34-9e21-8954f6749504|https://support.microsoft.com/en-us/topic/may-10-2022-kb5013942-os-builds-19042-1706-19043-1706-and-19044-1706-60b51119-85be-4a34-9e21-8954f6749504|MISC|['Patch', 'Vendor Advisory']
https://github.com/zeroSteiner/metasploit-framework/blob/feat/mod/cve-2022-32230/modules/auxiliary/dos/smb/smb_filenormalizednameinformation.rb|https://github.com/zeroSteiner/metasploit-framework/blob/feat/mod/cve-2022-32230/modules/auxiliary/dos/smb/smb_filenormalizednameinformation.rb|MISC|['Exploit', 'Third Party Advisory']
