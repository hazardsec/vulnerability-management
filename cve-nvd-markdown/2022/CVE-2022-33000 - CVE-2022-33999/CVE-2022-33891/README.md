# CVE-2022-33891


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-07-18 | 2022-10-27 | security@apache.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | The Apache Spark UI offers the possibility to enable ACLs via the configuration option spark.acls.enable. With an authentication filter, this checks whether a user has access permissions to view or modify the application. If ACLs are enabled, a code path in HttpSecurityFilter can allow someone to perform impersonation by providing an arbitrary user name. A malicious user might then be able to reach a permission check function that will ultimately build a Unix shell command based on their input, and execute it. This will result in arbitrary shell command execution as the user Spark is currently running as. This affects Apache Spark versions 3.0.3 and earlier, versions 3.1.1 to 3.1.2, and versions 3.2.0 to 3.2.1. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:apache:spark:*:*:*:*:*:*:*:* | []  3.0.3   | OR |
| True  cpe:2.3:a:apache:spark:*:*:*:*:*:*:*:* | [] | 3.2.0 | 3.2.1   | OR |
| True  cpe:2.3:a:apache:spark:*:*:*:*:*:*:*:* | [] | 3.1.1 | 3.1.2   | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 8.8 | HIGH | 5.9 | 2.8 | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H | 3.1 | NETWORK | LOW | LOW | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
*** Not Provided/Calculated ***

## Problem Type
CWE-77

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
N/A|https://lists.apache.org/thread/p847l3kopoo5bjtmxrcwk21xp6tjxqlc|CONFIRM|['Mailing List', 'Third Party Advisory']
http://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html|http://packetstormsecurity.com/files/168309/Apache-Spark-Unauthenticated-Command-Injection.html|MISC|['Exploit', 'Third Party Advisory', 'VDB Entry']
