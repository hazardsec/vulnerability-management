# CVE-2022-21672


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-01-10 | 2022-01-24 | security-advisories@github.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | make-ca is a utility to deliver and manage a complete PKI configuration for workstations and servers. Starting with version 0.9 and prior to version 1.10, make-ca misinterprets Mozilla certdata.txt and treats explicitly untrusted certificates like trusted ones, causing those explicitly untrusted certificates trusted by the system. The explicitly untrusted certificates were used by some CAs already hacked. Hostile attackers may perform a MIM attack exploiting them. Everyone using the affected versions of make-ca should upgrade to make-ca-1.10, and run `make-ca -f -g` as the `root` user to regenerate the trusted store immediately. As a workaround, users may delete the untrusted certificates from /etc/pki/tls and /etc/ssl/certs manually (or by a script), but this is not recommended because the manual changes will be overwritten next time running make-ca to update the trusted anchor. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:linuxfromscratch:make-ca:*:*:*:*:*:*:*:* | [] | 0.9   | 1.10 | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 6.5 | MEDIUM | 3.6 | 2.8 | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N | 3.1 | NETWORK | LOW | LOW | NONE | UNCHANGED | NONE | HIGH | NONE |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 4.3 | MEDIUM | 2.9 | 8.6 | AV:N/AC:M/Au:N/C:N/I:P/A:N | 2.0 | NETWORK | MEDIUM | NONE | False | False | False | False | NONE | PARTIAL | NONE |

## Problem Type
NVD-CWE-Other

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/lfs-book/make-ca/security/advisories/GHSA-m5qh-728v-4xrx|https://github.com/lfs-book/make-ca/security/advisories/GHSA-m5qh-728v-4xrx|CONFIRM|['Patch', 'Third Party Advisory']
https://github.com/lfs-book/make-ca/issues/19|https://github.com/lfs-book/make-ca/issues/19|MISC|['Issue Tracking', 'Mitigation', 'Third Party Advisory']
https://lists.linuxfromscratch.org/sympa/arc/blfs-support/2022-01/msg00020.html|https://lists.linuxfromscratch.org/sympa/arc/blfs-support/2022-01/msg00020.html|MISC|['Mailing List', 'Mitigation', 'Vendor Advisory']
https://github.com/lfs-book/make-ca/pull/20|https://github.com/lfs-book/make-ca/pull/20|MISC|['Patch', 'Third Party Advisory']
