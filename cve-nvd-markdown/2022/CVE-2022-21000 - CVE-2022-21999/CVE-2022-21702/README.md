# CVE-2022-21702


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-02-08 | 2022-09-10 | security-advisories@github.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Grafana is an open-source platform for monitoring and observability. In affected versions an attacker could serve HTML content thru the Grafana datasource or plugin proxy and trick a user to visit this HTML page using a specially crafted link and execute a Cross-site Scripting (XSS) attack. The attacker could either compromise an existing datasource for a specific Grafana instance or either set up its own public service and instruct anyone to set it up in their Grafana instance. To be impacted, all of the following must be applicable. For the data source proxy: A Grafana HTTP-based datasource configured with Server as Access Mode and a URL set, the attacker has to be in control of the HTTP server serving the URL of above datasource, and a specially crafted link pointing at the attacker controlled data source must be clicked on by an authenticated user. For the plugin proxy: A Grafana HTTP-based app plugin configured and enabled with a URL set, the attacker has to be in control of the HTTP server serving the URL of above app, and a specially crafted link pointing at the attacker controlled plugin must be clocked on by an authenticated user. For the backend plugin resource: An attacker must be able to navigate an authenticated user to a compromised plugin through a crafted link. Users are advised to update to a patched version. There are no known workarounds for this vulnerability. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:* | [] | 8.0.0   | 8.3.5 | OR |
| True  cpe:2.3:a:grafana:grafana:2.0.0:beta1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:grafana:grafana:2.0.0:beta3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:* | [] | 2.0.1   | 7.5.15 | OR |
| True  cpe:2.3:a:netapp:e-series_performance_analyzer:*:*:*:*:*:*:*:* | []    3.0 | OR |
| True  cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 5.4 | MEDIUM | 2.7 | 2.3 | CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N | 3.1 | NETWORK | LOW | LOW | REQUIRED | CHANGED | LOW | LOW | NONE |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 2.1 | LOW | 2.9 | 3.9 | AV:N/AC:H/Au:S/C:N/I:P/A:N | 2.0 | NETWORK | HIGH | SINGLE | True | False | False | False | NONE | PARTIAL | NONE |

## Problem Type
CWE-79

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/grafana/grafana/security/advisories/GHSA-xc3p-28hw-q24g|https://github.com/grafana/grafana/security/advisories/GHSA-xc3p-28hw-q24g|CONFIRM|['Exploit', 'Mitigation', 'Release Notes', 'Third Party Advisory']
https://grafana.com/blog/2022/02/08/grafana-7.5.15-and-8.3.5-released-with-moderate-severity-security-fixes/|https://grafana.com/blog/2022/02/08/grafana-7.5.15-and-8.3.5-released-with-moderate-severity-security-fixes/|MISC|['Release Notes', 'Vendor Advisory']
https://github.com/grafana/grafana/commit/27726868b3d7c613844b55cd209ca93645c99b85|https://github.com/grafana/grafana/commit/27726868b3d7c613844b55cd209ca93645c99b85|MISC|['Patch', 'Third Party Advisory']
https://security.netapp.com/advisory/ntap-20220303-0005/|https://security.netapp.com/advisory/ntap-20220303-0005/|CONFIRM|['Third Party Advisory']
FEDORA-2022-83405f9d5b|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/HLAQRRGNSO5MYCPAXGPH2OCSHOGHSQMQ/|FEDORA|['Mailing List', 'Third Party Advisory']
FEDORA-2022-9dd03cab55|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2PFW6Q2LXXWTFRTMTRN4ZGADFRQPKJ3D/|FEDORA|['Mailing List', 'Third Party Advisory']
FEDORA-2022-c5383675d9|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/36GUEPA5TPSC57DZTPYPBL6T7UPQ2FRH/|FEDORA|['Mailing List', 'Third Party Advisory']
