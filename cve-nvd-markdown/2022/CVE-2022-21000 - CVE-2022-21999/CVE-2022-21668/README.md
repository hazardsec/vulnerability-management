# CVE-2022-21668


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-01-10 | 2022-04-25 | security-advisories@github.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | pipenv is a Python development workflow tool. Starting with version 2018.10.9 and prior to version 2022.1.8, a flaw in pipenv's parsing of requirements files allows an attacker to insert a specially crafted string inside a comment anywhere within a requirements.txt file, which will cause victims who use pipenv to install the requirements file to download dependencies from a package index server controlled by the attacker. By embedding malicious code in packages served from their malicious index server, the attacker can trigger arbitrary remote code execution (RCE) on the victims' systems. If an attacker is able to hide a malicious `--index-url` option in a requirements file that a victim installs with pipenv, the attacker can embed arbitrary malicious code in packages served from their malicious index server that will be executed on the victim's host during installation (remote code execution/RCE). When pip installs from a source distribution, any code in the setup.py is executed by the install process. This issue is patched in version 2022.1.8. The GitHub Security Advisory contains more information about this vulnerability. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:pypa:pipenv:*:*:*:*:*:*:*:* | [] | 2018.10.9   | 2022.1.8 | OR |
| True  cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 8.6 | HIGH | 6.0 | 1.8 | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H | 3.1 | LOCAL | LOW | NONE | REQUIRED | CHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 9.3 | HIGH | 10.0 | 8.6 | AV:N/AC:M/Au:N/C:C/I:C/A:C | 2.0 | NETWORK | MEDIUM | NONE | True | False | False | False | COMPLETE | COMPLETE | COMPLETE |

## Problem Type
CWE-20
CWE-78
CWE-77
CWE-427
CWE-791

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/pypa/pipenv/releases/tag/v2022.1.8|https://github.com/pypa/pipenv/releases/tag/v2022.1.8|MISC|['Release Notes', 'Third Party Advisory']
https://github.com/pypa/pipenv/security/advisories/GHSA-qc9x-gjcv-465w|https://github.com/pypa/pipenv/security/advisories/GHSA-qc9x-gjcv-465w|CONFIRM|['Exploit', 'Third Party Advisory']
https://github.com/pypa/pipenv/commit/439782a8ae36c4762c88e43d5f0d8e563371b46f|https://github.com/pypa/pipenv/commit/439782a8ae36c4762c88e43d5f0d8e563371b46f|MISC|['Patch', 'Third Party Advisory']
FEDORA-2022-508e460384|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KCROBYHUS6DKQPCXBRPCZ5CDBNQTYAWT/|FEDORA|['Mailing List', 'Third Party Advisory']
FEDORA-2022-77ce20f03a|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QHQRIWKDP3SVJABAPEXBIQPKDI6UP7G4/|FEDORA|['Mailing List', 'Third Party Advisory']
FEDORA-2022-0d007466b3|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/56HBA3EOSLEDNCCBJVHE6DO34P56EOUM/|FEDORA|['Mailing List', 'Third Party Advisory']
