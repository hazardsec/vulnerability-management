# CVE-2022-22220


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-10-18 | 2022-10-20 | sirt@juniper.net | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | A Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability in Routing Protocol Daemon (rpd) of Juniper Networks Junos OS, Junos OS Evolved allows a network-based unauthenticated attacker to cause a Denial of Service (DoS). When a BGP flow route with redirect IP extended community is received, and the reachability to the next-hop of the corresponding redirect IP is flapping, the rpd process might crash. Whether the crash occurs depends on the timing of the internally processing of these two events and is outside the attackers control. Please note that this issue also affects Route-Reflectors unless 'routing-options flow firewall-install-disable' is configured. This issue affects: Juniper Networks Junos OS: 18.4 versions prior to 18.4R2-S10, 18.4R3-S10; 19.1 versions prior to 19.1R3-S7; 19.2 versions prior to 19.2R1-S8, 19.2R3-S4; 19.4 versions prior to 19.4R3-S8; 20.2 versions prior to 20.2R3-S3; 20.3 versions prior to 20.3R3-S2; 20.4 versions prior to 20.4R3; 21.1 versions prior to 21.1R2. Juniper Networks Junos OS Evolved: All versions prior to 20.4R2-EVO; 21.1-EVO versions prior to 21.1R2-EVO. This issue does not affect Juniper Networks Junos OS versions prior to 18.4R1. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:o:juniper:junos:18.4:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r1-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r1-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r1-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r1-s6:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r1-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r1-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r1-s7:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s6:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s7:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s8:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r1-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r1-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r1-s6:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r3-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r3-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r3-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r3-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r3-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r3-s7:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s9:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:*:*:*:*:*:*:*:* | []    18.4 | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r3-s10:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r1-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r3-s6:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r2-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.1:r3-s6:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r3-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:*:*:*:*:*:*:*:* | []    20.4 | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 5.9 | MEDIUM | 3.6 | 2.2 | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H | 3.1 | NETWORK | HIGH | NONE | NONE | UNCHANGED | NONE | NONE | HIGH |

## CVSSv2 Information
*** Not Provided/Calculated ***

## Problem Type
CWE-367

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://kb.juniper.net/JSA69902|https://kb.juniper.net/JSA69902|CONFIRM|['Vendor Advisory']
