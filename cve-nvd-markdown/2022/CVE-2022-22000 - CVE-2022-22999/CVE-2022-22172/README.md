# CVE-2022-22172


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-01-19 | 2022-02-01 | sirt@juniper.net | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | "A Missing Release of Memory after Effective Lifetime vulnerability in the Layer-2 control protocols daemon (l2cpd) of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated adjacent attacker to cause a memory leak. Continued exploitation can lead to memory exhaustion and thereby a Denial of Service (DoS). This issue occurs when specific LLDP packets are received. The impact of the l2cpd cores is that if any of the stp protocols (rstp, mstp or vstp) is used then stp re-converges and traffic loss will occur during that time. Also if any services depend on LLDP state (like PoE or VoIP device recognition) then these will also be affected. The memory utilization of the L2CPd process can be monitored with the following command: user@host> show system processes extensive  |  match l2cpd 1234 root 52 0 521M 43412K RUN 1 4:02 34.47% l2cpd This issue affects: Juniper Networks Junos OS 18.4 version 18.4R2-S4 and later versions prior to 18.4R2-S10. 19.2 versions prior to 19.2R1-S8, 19.2R3-S4; 19.3 versions prior to 19.3R3-S5; 19.4 versions prior to 19.4R3-S7; 20.1 versions prior to 20.1R3-S3; 20.2 versions prior to 20.2R3-S2; 20.3 versions prior to 20.3R3-S1; 20.4 versions prior to 20.4R3; 21.1 versions prior to 21.1R2-S2, 21.1R3; 21.2 versions prior to 21.2R2; Juniper Networks Junos OS Evolved All versions prior to 20.4R3-S2-EVO; 21.1 version 21.1R1-EVO and later versions; 21.2 versions prior to 21.2R2-EVO. This issue does not affect: Juniper Networks Junos OS 19.1 version 19.1R1 and later versions." |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:o:juniper:junos:19.2:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.3:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.3:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.3:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.3:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.3:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.3:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.3:r2-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.3:r2-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:r1-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s6:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s7:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s6:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.3:r2-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r1-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r3-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r3-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r3-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:r1-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s8:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:18.4:r2-s9:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s7:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r3-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r3-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.3:r2-s6:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.3:r3-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r1-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r2-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r3-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.4:r3-s6:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.1:r3-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.2:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.2:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.2:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.2:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.2:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.2:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.2:r2:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 6.5 | MEDIUM | 3.6 | 2.8 | CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H | 3.1 | ADJACENT_NETWORK | LOW | NONE | NONE | UNCHANGED | NONE | NONE | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 3.3 | LOW | 2.9 | 6.5 | AV:A/AC:L/Au:N/C:N/I:N/A:P | 2.0 | ADJACENT_NETWORK | LOW | NONE | False | False | False | False | NONE | NONE | PARTIAL |

## Problem Type
CWE-401

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://kb.juniper.net/JSA11278|https://kb.juniper.net/JSA11278|CONFIRM|['Vendor Advisory']
