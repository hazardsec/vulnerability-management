# CVE-2022-22225


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-10-18 | 2022-10-21 | sirt@juniper.net | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | A Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability in the Routing Protocol Daemon (rpd) of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated attacker with an established BGP session to cause a Denial of Service (DoS). In a BGP multipath scenario, when one of the contributing routes is flapping often and rapidly, rpd may crash. As this crash depends on whether a route is a contributing route, and on the internal timing of the events triggered by the flap this vulnerability is outside the direct control of a potential attacker. This issue affects: Juniper Networks Junos OS 19.2 versions prior to 19.2R3-S6; 20.2 versions prior to 20.2R3-S4; 20.3 versions prior to 20.3R3-S3; 20.4 versions prior to 20.4R3-S4; 21.1 versions prior to 21.1R3; 21.2 versions prior to 21.2R2; 21.3 versions prior to 21.3R2. Juniper Networks Junos OS Evolved All versions prior to 20.4R3-S4-EVO; 21.1-EVO version 21.1R1-EVO and later versions; 21.2-EVO versions prior to 21.2R2-EVO; 21.3-EVO versions prior to 21.3R2-EVO. This issue does not affect: Juniper Networks Junos OS versions 19.2 versions prior to 19.2R2, 19.3R1 and above prior to 20.2R1. Juniper Networks Junos OS Evolved versions prior to 20.2R1-EVO. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:o:juniper:junos:19.2:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s6:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r1-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r2-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s7:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s8:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r1-s9:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r3-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r3-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r3-s4:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:19.2:r3-s5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r3-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.2:r3-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.3:r3-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r3-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.1:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.2:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.2:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.2:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.2:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.3:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.3:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.3:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:20.4:r3-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos:21.3:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.2:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.2:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:*:*:*:*:*:*:*:* | []    20.4 | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.1:r3-s1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.2:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.2:r1-s2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.2:r3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.3:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.3:r1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:juniper:junos_os_evolved:21.3:r1-s1:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 5.9 | MEDIUM | 3.6 | 2.2 | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H | 3.1 | NETWORK | HIGH | NONE | NONE | UNCHANGED | NONE | NONE | HIGH |

## CVSSv2 Information
*** Not Provided/Calculated ***

## Problem Type
CWE-367

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://kb.juniper.net/JSA69875|https://kb.juniper.net/JSA69875|CONFIRM|['Vendor Advisory']
