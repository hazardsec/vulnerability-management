# CVE-2022-31014


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-07-05 | 2022-07-14 | security-advisories@github.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Nextcloud server is an open source personal cloud server. Affected versions were found to be vulnerable to SMTP command injection. The impact varies based on which commands are supported by the backend SMTP server. However, the main risk here is that the attacker can then hijack an already-authenticated SMTP session and run arbitrary SMTP commands as the email user, such as sending emails to other users, changing the FROM user, and so on. As before, this depends on the configuration of the server itself, but newlines should be sanitized to mitigate such arbitrary SMTP command injection. It is recommended that the Nextcloud Server is upgraded to 22.2.8 , 23.0.5 or 24.0.1. There are no known workarounds for this issue. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:*:*:*:* | []    22.2.8 | OR |
| True  cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:*:*:*:* | [] | 23.0.0   | 23.0.5 | OR |
| True  cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:rc1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:rc2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:rc3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:-:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:enterprise:*:*:* | []    19.0.13.7 | OR |
| True  cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:enterprise:*:*:* | [] | 21.0.0   | 21.0.9.5 | OR |
| True  cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:enterprise:*:*:* | [] | 20.0.0   | 20.0.14.6 | OR |
| True  cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:beta1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:beta2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:beta3:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 3.5 | LOW | 1.4 | 2.1 | CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N | 3.1 | NETWORK | LOW | LOW | REQUIRED | UNCHANGED | NONE | LOW | NONE |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 3.5 | LOW | 2.9 | 6.8 | AV:N/AC:M/Au:S/C:N/I:P/A:N | 2.0 | NETWORK | MEDIUM | SINGLE | True | False | False | False | NONE | PARTIAL | NONE |

## Problem Type
CWE-74
CWE-93

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/nextcloud/security-advisories/security/advisories/GHSA-264h-3v4w-6xh2|https://github.com/nextcloud/security-advisories/security/advisories/GHSA-264h-3v4w-6xh2|CONFIRM|['Exploit', 'Third Party Advisory']
https://hackerone.com/reports/1516377|https://hackerone.com/reports/1516377|MISC|['Exploit', 'Issue Tracking', 'Patch', 'Third Party Advisory']
https://github.com/nextcloud/server/pull/32428|https://github.com/nextcloud/server/pull/32428|MISC|['Issue Tracking', 'Patch', 'Third Party Advisory']
