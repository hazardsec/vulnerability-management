# CVE-2022-31015


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-05-31 23:15:00 | 2022-06-14 19:12:00 | security-advisories@github.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Waitress is a Web Server Gateway Interface server for Python 2 and 3. Waitress versions 2.1.0 and 2.1.1 may terminate early due to a thread closing a socket while the main thread is about to call select(). This will lead to the main thread raising an exception that is not handled and then causing the entire application to be killed. This issue has been fixed in Waitress 2.1.2 by no longer allowing the WSGI thread to close the socket. Instead, that is always delegated to the main thread. There is no work-around for this issue. However, users using waitress behind a reverse proxy server are less likely to have issues if the reverse proxy always reads the full response. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:agendaless:waitress:*:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 5.9 | MEDIUM | 3.6 | 2.2 | CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H | 3.1 | NETWORK | HIGH | NONE | NONE | UNCHANGED | NONE | NONE | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 4.3 | MEDIUM | 2.9 | 8.6 | AV:N/AC:M/Au:N/C:N/I:N/A:P | 2.0 | NETWORK | MEDIUM | NONE | 0 | False | False | False | NONE | NONE | PARTIAL |

## Problem Type
CWE-362
CWE-248

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/Pylons/waitress/pull/377|https://github.com/Pylons/waitress/pull/377|MISC|['Issue Tracking', 'Patch', 'Third Party Advisory']
https://github.com/Pylons/waitress/issues/374|https://github.com/Pylons/waitress/issues/374|MISC|['Exploit', 'Issue Tracking', 'Patch', 'Third Party Advisory']
https://github.com/Pylons/waitress/security/advisories/GHSA-f5x9-8jwc-25rw|https://github.com/Pylons/waitress/security/advisories/GHSA-f5x9-8jwc-25rw|CONFIRM|['Third Party Advisory']
https://github.com/Pylons/waitress/commit/4f6789b035610e0552738cdc4b35ca809a592d48|https://github.com/Pylons/waitress/commit/4f6789b035610e0552738cdc4b35ca809a592d48|MISC|['Patch', 'Third Party Advisory']
