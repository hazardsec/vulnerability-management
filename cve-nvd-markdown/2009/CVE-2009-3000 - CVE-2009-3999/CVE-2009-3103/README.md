# CVE-2009-3103


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2009-09-08 22:30:00 | 2018-10-12 21:52:00 | secure@microsoft.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | "Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2, Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a denial of service (system crash) via an & (ampersand) character in a Process ID High header field in a NEGOTIATE PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location, aka ""SMBv2 Negotiation Vulnerability."" NOTE: some of these details are obtained from third party information." |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:o:microsoft:windows_vista:*:sp2:x64:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_server_2008:*:sp2:itanium:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_server_2008:sp2:x64:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_server_2008:sp2:x32:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_vista:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_vista:*:sp1:x64:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_server_2008:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_server_2008:*:*:x32:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_server_2008:*:*:x64:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_vista:*:sp1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_server_2008:*:*:itanium:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:microsoft:windows_vista:*:sp2:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
*** Not Provided/Calculated ***

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 10.0 | HIGH | 10.0 | 10.0 | AV:N/AC:L/Au:N/C:C/I:C/A:C | 2.0 | NETWORK | LOW | NONE | 0 | False | False | False | COMPLETE | COMPLETE | COMPLETE |

## Problem Type
CWE-399

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
20090907 Windows Vista/7 : SMB2.0 NEGOTIATE PROTOCOL REQUEST Remote B.S.O.D.|http://archives.neohapsis.com/archives/fulldisclosure/2009-09/0090.html|FULLDISC|['Exploit']
36299|http://www.securityfocus.com/bid/36299|BID|['Exploit']
http://isc.sans.org/diary.html?storyid=7093|http://isc.sans.org/diary.html?storyid=7093|MISC|[]
36623|http://secunia.com/advisories/36623|SECUNIA|['Vendor Advisory']
http://g-laurent.blogspot.com/2009/09/windows-vista7-smb20-negotiate-protocol.html|http://g-laurent.blogspot.com/2009/09/windows-vista7-smb20-negotiate-protocol.html|MISC|['Exploit']
TA09-286A|http://www.us-cert.gov/cas/techalerts/TA09-286A.html|CERT|['US Government Resource']
http://blog.48bits.com/?p=510|http://blog.48bits.com/?p=510|MISC|[]
1022848|http://www.securitytracker.com/id?1022848|SECTRACK|[]
http://www.reversemode.com/index.php?option=com_content&task=view&id=64&Itemid=1|http://www.reversemode.com/index.php?option=com_content&task=view&id=64&Itemid=1|MISC|[]
http://www.microsoft.com/technet/security/advisory/975497.mspx|http://www.microsoft.com/technet/security/advisory/975497.mspx|CONFIRM|['Vendor Advisory']
57799|http://osvdb.org/57799|OSVDB|[]
VU#135940|http://www.kb.cert.org/vuls/id/135940|CERT-VN|['US Government Resource']
win-srv2sys-code-execution(53090)|https://exchange.xforce.ibmcloud.com/vulnerabilities/53090|XF|[]
oval:org.mitre.oval:def:6489|https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A6489|OVAL|[]
9594|http://www.exploit-db.com/exploits/9594|EXPLOIT-DB|[]
20090909 SMB SRV2.SYS Denial of Service PoC|http://www.securityfocus.com/archive/1/506327/100/0/threaded|BUGTRAQ|[]
20090908 Regarding Microsoft srv2.sys SMB2.0 NEGOTIATE BSOD|http://www.securityfocus.com/archive/1/506300/100/0/threaded|BUGTRAQ|[]
MS09-050|https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-050|MS|[]
