# CVE-2015-1158


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2015-06-26 10:59:00 | 2017-09-23 01:29:00 | product-security@apple.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | The add_job function in scheduler/ipp.c in cupsd in CUPS before 2.0.3 performs incorrect free operations for multiple-value job-originating-host-name attributes, which allows remote attackers to trigger data corruption for reference-counted strings via a crafted (1) IPP_CREATE_JOB or (2) IPP_PRINT_JOB request, as demonstrated by replacing the configuration file and consequently executing arbitrary code. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:cups:cups:*:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
*** Not Provided/Calculated ***

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 10.0 | HIGH | 10.0 | 10.0 | AV:N/AC:L/Au:N/C:C/I:C/A:C | 2.0 | NETWORK | LOW | NONE | 0 | False | False | False | COMPLETE | COMPLETE | COMPLETE |

## Problem Type
CWE-254

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://bugzilla.redhat.com/show_bug.cgi?id=1221641|https://bugzilla.redhat.com/show_bug.cgi?id=1221641|CONFIRM|[]
https://code.google.com/p/google-security-research/issues/detail?id=455|https://code.google.com/p/google-security-research/issues/detail?id=455|MISC|[]
http://googleprojectzero.blogspot.in/2015/06/owning-internet-printing-case-study-in.html|http://googleprojectzero.blogspot.in/2015/06/owning-internet-printing-case-study-in.html|MISC|[]
http://www.cups.org/blog.php?L1082|http://www.cups.org/blog.php?L1082|CONFIRM|['Vendor Advisory']
https://bugzilla.opensuse.org/show_bug.cgi?id=924208|https://bugzilla.opensuse.org/show_bug.cgi?id=924208|CONFIRM|[]
https://www.cups.org/str.php?L4609|https://www.cups.org/str.php?L4609|CONFIRM|['Vendor Advisory']
VU#810572|http://www.kb.cert.org/vuls/id/810572|CERT-VN|['Third Party Advisory', 'US Government Resource']
75098|http://www.securityfocus.com/bid/75098|BID|[]
GLSA-201510-07|https://security.gentoo.org/glsa/201510-07|GENTOO|[]
http://kb.juniper.net/InfoCenter/index?page=content&id=JSA10702|http://kb.juniper.net/InfoCenter/index?page=content&id=JSA10702|CONFIRM|[]
openSUSE-SU-2015:1056|http://lists.opensuse.org/opensuse-security-announce/2015-06/msg00010.html|SUSE|[]
SUSE-SU-2015:1044|http://lists.opensuse.org/opensuse-security-announce/2015-06/msg00006.html|SUSE|[]
SUSE-SU-2015:1041|http://lists.opensuse.org/opensuse-security-announce/2015-06/msg00003.html|SUSE|[]
USN-2629-1|http://www.ubuntu.com/usn/USN-2629-1|UBUNTU|[]
DSA-3283|http://www.debian.org/security/2015/dsa-3283|DEBIAN|[]
RHSA-2015:1123|http://rhn.redhat.com/errata/RHSA-2015-1123.html|REDHAT|[]
https://github.com/0x00string/oldays/blob/master/CVE-2015-1158.py|https://github.com/0x00string/oldays/blob/master/CVE-2015-1158.py|MISC|[]
41233|https://www.exploit-db.com/exploits/41233/|EXPLOIT-DB|[]
37336|https://www.exploit-db.com/exploits/37336/|EXPLOIT-DB|[]
1032556|http://www.securitytracker.com/id/1032556|SECTRACK|[]
