# CVE-2007-6015


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2007-12-13 | 2018-10-30 | PSIRT-CNA@flexerasoftware.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | "Stack-based buffer overflow in the send_mailslot function in nmbd in Samba 3.0.0 through 3.0.27a, when the ""domain logons"" option is enabled, allows remote attackers to execute arbitrary code via a GETDC mailslot request composed of a long GETDC string following an offset username in a SAMLOGON logon request." |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:samba:samba:3.0.14a:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.1a:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.27:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.0.10:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.12:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.25:pre2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.0.1:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.25b:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.3a:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.3:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.8a:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.9:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.13:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.21b:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.0.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.11:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.20a:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.20b:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.0.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.25:rc1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.26a:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.2a:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.0.6:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.7a:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.11:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.21a:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.0.7:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.0.8:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.14:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.21c:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.25:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.25:pre1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.25c:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.26:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.0.3:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.0a:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.6:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.7:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.1:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.10:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.20:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.23b:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.23c:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.25:rc2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.25:rc3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.0.9:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.5:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.22:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.23a:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.0.5:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:2.2.8:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.12:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.21:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.23d:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.24:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:samba:samba:3.0.25a:*:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
*** Not Provided/Calculated ***

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 9.3 | HIGH | 10.0 | 8.6 | AV:N/AC:M/Au:N/C:C/I:C/A:C | 2.0 | NETWORK | MEDIUM | NONE | False | True | False | False | COMPLETE | COMPLETE | COMPLETE |

## Problem Type
CWE-119

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
http://secunia.com/secunia_research/2007-99/advisory/|http://secunia.com/secunia_research/2007-99/advisory/|MISC|['Vendor Advisory']
http://www.samba.org/samba/security/CVE-2007-6015.html|http://www.samba.org/samba/security/CVE-2007-6015.html|CONFIRM|['Patch']
RHSA-2007:1114|http://www.redhat.com/support/errata/RHSA-2007-1114.html|REDHAT|['Patch']
26791|http://www.securityfocus.com/bid/26791|BID|[]
27760|http://secunia.com/advisories/27760|SECUNIA|['Vendor Advisory']
http://bugs.gentoo.org/show_bug.cgi?id=200773|http://bugs.gentoo.org/show_bug.cgi?id=200773|CONFIRM|[]
http://support.avaya.com/elmodocs2/security/ASA-2007-520.htm|http://support.avaya.com/elmodocs2/security/ASA-2007-520.htm|CONFIRM|[]
https://issues.rpath.com/browse/RPL-1976|https://issues.rpath.com/browse/RPL-1976|CONFIRM|[]
FEDORA-2007-4269|https://www.redhat.com/archives/fedora-package-announce/2007-December/msg00304.html|FEDORA|[]
FEDORA-2007-4275|https://www.redhat.com/archives/fedora-package-announce/2007-December/msg00308.html|FEDORA|[]
GLSA-200712-10|http://security.gentoo.org/glsa/glsa-200712-10.xml|GENTOO|[]
MDKSA-2007:244|http://www.mandriva.com/security/advisories?name=MDKSA-2007:244|MANDRIVA|[]
RHSA-2007:1117|http://www.redhat.com/support/errata/RHSA-2007-1117.html|REDHAT|[]
SSA:2007-344-01|http://slackware.com/security/viewer.php?l=slackware-security&y=2007&m=slackware-security.451554|SLACKWARE|[]
SUSE-SA:2007:068|http://www.novell.com/linux/security/advisories/2007_68_samba.html|SUSE|[]
USN-556-1|http://www.ubuntu.com/usn/usn-556-1|UBUNTU|[]
1019065|http://www.securitytracker.com/id?1019065|SECTRACK|[]
27894|http://secunia.com/advisories/27894|SECUNIA|[]
27977|http://secunia.com/advisories/27977|SECUNIA|[]
27993|http://secunia.com/advisories/27993|SECUNIA|[]
27999|http://secunia.com/advisories/27999|SECUNIA|[]
28003|http://secunia.com/advisories/28003|SECUNIA|[]
28028|http://secunia.com/advisories/28028|SECUNIA|[]
28029|http://secunia.com/advisories/28029|SECUNIA|[]
28067|http://secunia.com/advisories/28067|SECUNIA|[]
28089|http://secunia.com/advisories/28089|SECUNIA|[]
28037|http://secunia.com/advisories/28037|SECUNIA|[]
APPLE-SA-2008-02-11|http://lists.apple.com/archives/security-announce/2008/Feb/msg00002.html|APPLE|[]
TA08-043B|http://www.us-cert.gov/cas/techalerts/TA08-043B.html|CERT|['US Government Resource']
28891|http://secunia.com/advisories/28891|SECUNIA|[]
[Security-announce] 20080221 VMSA-2008-0003 Moderate: Updated aacraid driver and samba and python service console updates|http://lists.vmware.com/pipermail/security-announce/2008/000005.html|MLIST|[]
VU#438395|http://www.kb.cert.org/vuls/id/438395|CERT-VN|['US Government Resource']
29032|http://secunia.com/advisories/29032|SECUNIA|[]
29341|http://secunia.com/advisories/29341|SECUNIA|[]
3438|http://securityreason.com/securityalert/3438|SREASON|[]
238251|http://sunsolve.sun.com/search/document.do?assetkey=1-26-238251-1|SUNALERT|[]
30484|http://secunia.com/advisories/30484|SECUNIA|[]
HPSBUX02341|http://www11.itrc.hp.com/service/cki/docDisplay.do?docId=emr_na-c01475657|HP|[]
30835|http://secunia.com/advisories/30835|SECUNIA|[]
1019295|http://sunsolve.sun.com/search/document.do?assetkey=1-77-1019295.1-1|SUNALERT|[]
ADV-2008-0859|http://www.vupen.com/english/advisories/2008/0859/references|VUPEN|[]
ADV-2008-0495|http://www.vupen.com/english/advisories/2008/0495/references|VUPEN|[]
HPSBUX02316|http://marc.info/?l=bugtraq&m=120524782005154&w=2|HP|[]
ADV-2008-1908|http://www.vupen.com/english/advisories/2008/1908|VUPEN|[]
ADV-2007-4153|http://www.vupen.com/english/advisories/2007/4153|VUPEN|[]
ADV-2008-0637|http://www.vupen.com/english/advisories/2008/0637|VUPEN|[]
ADV-2008-1712|http://www.vupen.com/english/advisories/2008/1712/references|VUPEN|[]
http://docs.info.apple.com/article.html?artnum=307430|http://docs.info.apple.com/article.html?artnum=307430|CONFIRM|[]
DSA-1427|http://www.debian.org/security/2007/dsa-1427|DEBIAN|[]
samba-sendmailslot-bo(38965)|https://exchange.xforce.ibmcloud.com/vulnerabilities/38965|XF|[]
oval:org.mitre.oval:def:5605|https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A5605|OVAL|[]
oval:org.mitre.oval:def:11572|https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A11572|OVAL|[]
20080221 VMSA-2008-0003 Moderate: Updated aacraid driver and samba and python service console updates|http://www.securityfocus.com/archive/1/488457/100/0/threaded|BUGTRAQ|[]
20071214 POC for samba send_mailslot()|http://www.securityfocus.com/archive/1/485144/100/0/threaded|BUGTRAQ|[]
20071210 rPSA-2007-0261-1 samba samba-swat|http://www.securityfocus.com/archive/1/484827/100/0/threaded|BUGTRAQ|[]
20071210 [SECURITY] Buffer overrun in send_mailslot()|http://www.securityfocus.com/archive/1/484825/100/0/threaded|BUGTRAQ|[]
20071210 Secunia Research: Samba "send_mailslot()" Buffer OverflowVulnerability|http://www.securityfocus.com/archive/1/484818/100/0/threaded|BUGTRAQ|[]
