# CVE-2021-44832


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-12-28 20:15:00 | 2022-08-09 01:24:00 | security@apache.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Apache Log4j2 versions 2.0-beta7 through 2.17.0 (excluding security fix releases 2.3.2 and 2.12.4) are vulnerable to a remote code execution (RCE) attack when a configuration uses a JDBC Appender with a JNDI LDAP data source URI when an attacker has control of the target LDAP server. This issue is fixed by limiting JNDI data source names to the java protocol in Log4j2 versions 2.17.1, 2.12.4, and 2.3.2. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:apache:log4j:2.0:rc1:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:apache:log4j:2.0:beta9:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:apache:log4j:2.0:rc2:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:apache:log4j:2.0:beta8:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:apache:log4j:2.0:beta7:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:apache:log4j:2.0:-:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:apache:log4j:*:*:*:*:*:*:*:* | [] | 2.13.0 | 2.17.1  OR |
| True | cpe:2.3:a:apache:log4j:*:*:*:*:*:*:*:* | [] | 2.4 | 2.12.4  OR |
| True | cpe:2.3:a:apache:log4j:*:*:*:*:*:*:*:* | [] | 2.0.1 | 2.3.2  OR |
| True | cpe:2.3:a:oracle:weblogic_server:12.2.1.3.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_unifier:18.8:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:weblogic_server:12.2.1.4.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_unifier:19.12:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:weblogic_server:14.1.1.0.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_unifier:20.12:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:communications_interactive_session_recorder:6.3:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:communications_interactive_session_recorder:6.4:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_gateway:*:*:*:*:*:*:*:* | [] | 17.12.0  17.12.11 | OR |
| True | cpe:2.3:a:oracle:primavera_gateway:*:*:*:*:*:*:*:* | [] | 20.12.0  20.12.7 | OR |
| True | cpe:2.3:a:oracle:retail_assortment_planning:16.0.3:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_unifier:21.12:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_p6_enterprise_project_portfolio_management:21.12.0.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_p6_enterprise_project_portfolio_management:*:*:*:*:*:*:*:* | [] | 20.12.0.0  20.12.12.0 | OR |
| True | cpe:2.3:a:oracle:primavera_gateway:21.12.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_gateway:*:*:*:*:*:*:*:* | [] | 19.12.0  19.12.12 | OR |
| True | cpe:2.3:a:oracle:primavera_gateway:*:*:*:*:*:*:*:* | [] | 18.8.0  18.8.13 | OR |
| True | cpe:2.3:a:oracle:retail_fiscal_management:14.2:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_p6_enterprise_project_portfolio_management:*:*:*:*:*:*:*:* | [] | 19.12.0  19.12.18.0 | OR |
| True | cpe:2.3:a:oracle:siebel_ui_framework:21.12:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:communications_diameter_signaling_router:*:*:*:*:*:*:*:* | [] | 8.0.0.0  8.5.1.0 | OR |
| True | cpe:2.3:a:cisco:cloudcenter:4.10.0.16:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:flexcube_private_banking:12.1.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:weblogic_server:12.2.1.3.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_unifier:18.8:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:weblogic_server:12.2.1.4.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_unifier:19.12:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:weblogic_server:14.1.1.0.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_unifier:20.12:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:retail_order_broker:18.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:communications_interactive_session_recorder:6.3:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:communications_interactive_session_recorder:6.4:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_gateway:*:*:*:*:*:*:*:* | [] | 17.12.0  17.12.11 | OR |
| True | cpe:2.3:a:oracle:primavera_gateway:*:*:*:*:*:*:*:* | [] | 20.12.0  20.12.7 | OR |
| True | cpe:2.3:a:oracle:primavera_unifier:21.12:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:siebel_ui_framework:*:*:*:*:*:*:*:* | []   | 21.12 | OR |
| True | cpe:2.3:a:oracle:primavera_p6_enterprise_project_portfolio_management:21.12.0.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_p6_enterprise_project_portfolio_management:*:*:*:*:*:*:*:* | [] | 20.12.0.0  20.12.12.0 | OR |
| True | cpe:2.3:a:oracle:primavera_p6_enterprise_project_portfolio_management:*:*:*:*:*:*:*:* | [] | 19.12.0.0  19.12.18.0 | OR |
| True | cpe:2.3:a:oracle:primavera_gateway:21.12.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:primavera_gateway:*:*:*:*:*:*:*:* | [] | 19.12.0  19.12.12 | OR |
| True | cpe:2.3:a:oracle:primavera_gateway:*:*:*:*:*:*:*:* | [] | 18.8.0  18.8.13 | OR |
| True | cpe:2.3:a:oracle:communications_diameter_signaling_router:*:*:*:*:*:*:*:* | [] | 8.3.0.0  8.5.1.0 | OR |
| True | cpe:2.3:a:oracle:retail_xstore_point_of_service:17.0.4:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:retail_xstore_point_of_service:18.0.3:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:retail_xstore_point_of_service:19.0.2:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:retail_xstore_point_of_service:20.0.1:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:retail_order_broker:19.1:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:policy_automation:*:*:*:*:*:*:*:* | [] | 12.2.0  12.2.24 | OR |
| True | cpe:2.3:a:oracle:product_lifecycle_analytics:3.6.1:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:retail_xstore_point_of_service:21.0.1:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:policy_automation_for_mobile_devices:*:*:*:*:*:*:*:* | [] | 12.2.0  12.2.24 | OR |
| True | cpe:2.3:a:oracle:health_sciences_data_management_workbench:3.0.0.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:health_sciences_data_management_workbench:3.1.0.3:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:health_sciences_data_management_workbench:2.5.2.1:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:communications_brm_-_elastic_charging_engine:12.0.0.5.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:communications_offline_mediation_controller:12.0.0.5.0:*:*:*:*:*:*:* | []    OR |
| True | cpe:2.3:a:oracle:communications_offline_mediation_controller:*:*:*:*:*:*:*:* | []  12.0.0.4.4  OR |
| True | cpe:2.3:a:oracle:communications_brm_-_elastic_charging_engine:*:*:*:*:*:*:*:* | []  12.0.0.4.6  OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 6.6 | MEDIUM | 5.9 | 0.7 | CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H | 3.1 | NETWORK | HIGH | HIGH | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 8.5 | HIGH | 10.0 | 6.8 | AV:N/AC:M/Au:S/C:C/I:C/A:C | 2.0 | NETWORK | MEDIUM | SINGLE | 0 | False | False | False | COMPLETE | COMPLETE | COMPLETE |

## Problem Type
CWE-20

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://lists.apache.org/thread/s1o5vlo78ypqxnzn6p8zf6t9shtq5143|https://lists.apache.org/thread/s1o5vlo78ypqxnzn6p8zf6t9shtq5143|MISC|['Mailing List', 'Vendor Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://issues.apache.org/jira/browse/LOG4J2-3293|https://issues.apache.org/jira/browse/LOG4J2-3293|MISC|['Issue Tracking', 'Patch', 'Vendor Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
[oss-security] 20211228 CVE-2021-44832: Apache Log4j2 vulnerable to RCE via JDBC Appender when attacker controls configuration|http://www.openwall.com/lists/oss-security/2021/12/28/1|MLIST|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://cert-portal.siemens.com/productcert/pdf/ssa-784507.pdf|https://cert-portal.siemens.com/productcert/pdf/ssa-784507.pdf|CONFIRM|['Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
[debian-lts-announce] 20211229 [SECURITY] [DLA 2870-1] apache-log4j2 security update|https://lists.debian.org/debian-lts-announce/2021/12/msg00036.html|MLIST|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://security.netapp.com/advisory/ntap-20220104-0001/|https://security.netapp.com/advisory/ntap-20220104-0001/|CONFIRM|['Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
FEDORA-2021-1bd9151bab|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/T57MPJUW3MA6QGWZRTMCHHMMPQNVKGFC/|FEDORA|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
FEDORA-2021-c6f471ce0f|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EVV25FXL4FU5X6X5BSL7RLQ7T6F65MRA/|FEDORA|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
20211210 Vulnerabilities in Apache Log4j Library Affecting Cisco Products: December 2021|https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apache-log4j-qRuKNEbd|CISCO|['Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://www.oracle.com/security-alerts/cpujan2022.html|https://www.oracle.com/security-alerts/cpujan2022.html|MISC|['Patch', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://www.oracle.com/security-alerts/cpuapr2022.html|https://www.oracle.com/security-alerts/cpuapr2022.html|MISC|['Patch', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
N/A|https://www.oracle.com/security-alerts/cpujul2022.html|N/A|['Patch', 'Third Party Advisory']
