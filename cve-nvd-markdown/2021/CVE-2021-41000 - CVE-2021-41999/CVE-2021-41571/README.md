# CVE-2021-41571


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-02-01 13:15:00 | 2022-02-09 15:47:00 | security@apache.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | In Apache Pulsar it is possible to access data from BookKeeper that does not belong to the topics accessible by the authenticated user. The Admin API get-message-by-id requires the user to input a topic and a ledger id. The ledger id is a pointer to the data, and it is supposed to be a valid it for the topic. Authorisation controls are performed against the topic name and there is not proper validation the that ledger id is valid in the context of such ledger. So it may happen that the user is able to read from a ledger that contains data owned by another tenant. This issue affects Apache Pulsar Apache Pulsar version 2.8.0 and prior versions; Apache Pulsar version 2.7.3 and prior versions; Apache Pulsar version 2.6.4 and prior versions. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:apache:pulsar:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:pulsar:2.8.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:pulsar:*:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 6.5 | MEDIUM | 3.6 | 2.8 | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N | 3.1 | NETWORK | LOW | LOW | NONE | UNCHANGED | HIGH | NONE | NONE |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 4.0 | MEDIUM | 2.9 | 8.0 | AV:N/AC:L/Au:S/C:P/I:N/A:N | 2.0 | NETWORK | LOW | SINGLE | 0 | False | False | False | PARTIAL | NONE | NONE |

## Problem Type
CWE-20

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/apache/pulsar/issues/11814|https://github.com/apache/pulsar/issues/11814|MISC|['Exploit', 'Issue Tracking', 'Patch', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://lists.apache.org/thread/8n3k7pvyh4cf9q2jfzb6pb32ync6xlvr|https://lists.apache.org/thread/8n3k7pvyh4cf9q2jfzb6pb32ync6xlvr|MISC|['Mailing List', 'Vendor Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://pulsar.apache.org/admin-rest-api/#operation/getLastMessageId|https://pulsar.apache.org/admin-rest-api/#operation/getLastMessageId|MISC|['Patch', 'Vendor Advisory']
