# CVE-2021-31876


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-05-13 22:15:00 | 2021-05-26 20:12:00 | cve@mitre.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Bitcoin Core 0.12.0 through 0.21.1 does not properly implement the replacement policy specified in BIP125, which makes it easier for attackers to trigger a loss of funds, or a denial of service attack against downstream projects such as Lightning network nodes. An unconfirmed child transaction with nSequence = 0xff_ff_ff_ff, spending an unconfirmed parent with nSequence <= 0xff_ff_ff_fd, should be replaceable because there is inherited signaling by the child transaction. However, the actual PreChecks implementation does not enforce this. Instead, mempool rejects the replacement attempt of the unconfirmed child transaction. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:bitcoin:bitcoin:*:*:*:*:*:*:*:* | 0.12.0 | 0.21.1 | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 6.5 | MEDIUM | 2.5 | 3.9 | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L | 3.1 | NETWORK | LOW | NONE | NONE | UNCHANGED | NONE | LOW | LOW |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 6.4 | MEDIUM | 4.9 | 10.0 | AV:N/AC:L/Au:N/C:N/I:P/A:P | 2.0 | NETWORK | LOW | NONE | 0 | False | False | False | NONE | PARTIAL | PARTIAL |

## Problem Type
CWE-863

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://en.bitcoin.it/wiki/Common_Vulnerabilities_and_Exposures#CVE-2021-31876|https://en.bitcoin.it/wiki/Common_Vulnerabilities_and_Exposures#CVE-2021-31876|MISC|['Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://bitcoinops.org/en/newsletters/2021/05/12/|https://bitcoinops.org/en/newsletters/2021/05/12/|MISC|['Vendor Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://bitcoinops.org/en/topics/replace-by-fee/|https://bitcoinops.org/en/topics/replace-by-fee/|MISC|['Vendor Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-May/018893.html|https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-May/018893.html|MISC|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/bitcoin/bitcoin|https://github.com/bitcoin/bitcoin|MISC|['Third Party Advisory']
