# CVE-2021-3656


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-03-04 19:15:00 | 2022-03-10 18:55:00 | secalert@redhat.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | "A flaw was found in the KVM's AMD code for supporting SVM nested virtualization. The flaw occurs when processing the VMCB (virtual machine control block) provided by the L1 guest to spawn/handle a nested guest (L2). Due to improper validation of the ""virt_ext"" field, this issue could allow a malicious L1 to disable both VMLOAD/VMSAVE intercepts and VLS (Virtual VMLOAD/VMSAVE) for the L2 guest. As a result, the L2 guest would be allowed to read/write physical pages of the host, resulting in a crash of the entire system, leak of sensitive data or potential guest-to-host escape." |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:o:linux:linux_kernel:5.14:rc1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:linux:linux_kernel:5.14:rc2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:linux:linux_kernel:5.14:-:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:linux:linux_kernel:5.14:rc3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:linux:linux_kernel:5.14:rc4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:linux:linux_kernel:5.14:rc5:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:linux:linux_kernel:5.14:rc6:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_desktop:7.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_workstation:7.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_scientific_computing:7.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server:7.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_power_little_endian:7.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_real_time:7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_real_time_for_nfv:7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_power_big_endian:7.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_ibm_z_systems:7.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:redhat:openstack:13:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_eus:8.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_eus:8.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_eus:8.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_real_time:8:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_real_time_for_nfv_tus:8.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_real_time_for_nfv_tus:8.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_real_time_tus:8.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_real_time_tus:8.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_aus:7.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_aus:7.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_aus:8.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_aus:8.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_tus:7.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_tus:7.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_tus:8.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_tus:8.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_ibm_z_systems:8.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_ibm_z_systems_eus:8.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_ibm_z_systems_eus:8.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_ibm_z_systems_eus:8.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_power_little_endian:8.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_power_little_endian_eus:8.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_power_little_endian_eus:8.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_power_little_endian_eus:8.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_for_real_time_for_nfv:8:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_for_power_little_endian_update_services_for_sap_solutions:7.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_for_power_little_endian_update_services_for_sap_solutions:8.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_for_power_little_endian_update_services_for_sap_solutions:8.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_for_power_little_endian_update_services_for_sap_solutions:8.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_update_services_for_sap_solutions:7.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_update_services_for_sap_solutions:7.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_update_services_for_sap_solutions:8.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_update_services_for_sap_solutions:8.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server_update_services_for_sap_solutions:8.4:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 8.8 | HIGH | 6.0 | 2.0 | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H | 3.1 | LOCAL | LOW | LOW | NONE | CHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 7.2 | HIGH | 10.0 | 3.9 | AV:L/AC:L/Au:N/C:C/I:C/A:C | 2.0 | LOCAL | LOW | NONE | 0 | False | False | False | COMPLETE | COMPLETE | COMPLETE |

## Problem Type
CWE-862

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://www.openwall.com/lists/oss-security/2021/08/16/1|https://www.openwall.com/lists/oss-security/2021/08/16/1|MISC|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/torvalds/linux/commit/c7dfa4009965a9b2d7b329ee970eb8da0d32f0bc|https://github.com/torvalds/linux/commit/c7dfa4009965a9b2d7b329ee970eb8da0d32f0bc|MISC|['Patch', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://bugzilla.redhat.com/show_bug.cgi?id=1983988|https://bugzilla.redhat.com/show_bug.cgi?id=1983988|MISC|['Issue Tracking', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://git.kernel.org/pub/scm/virt/kvm/kvm.git/commit/?id=c7dfa4009965a9b2d7b329ee970eb8da0d32f0bc|https://git.kernel.org/pub/scm/virt/kvm/kvm.git/commit/?id=c7dfa4009965a9b2d7b329ee970eb8da0d32f0bc|MISC|['Patch', 'Third Party Advisory']
