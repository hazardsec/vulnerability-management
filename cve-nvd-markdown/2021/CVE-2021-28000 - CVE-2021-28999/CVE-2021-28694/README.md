# CVE-2021-28694


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-08-27 | 2022-09-28 | security@xen.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | IOMMU page mapping issues on x86 T[his CNA information record relates to multiple CVEs; the text explains which aspects/vulnerabilities correspond to which CVE.] Both AMD and Intel allow ACPI tables to specify regions of memory which should be left untranslated, which typically means these addresses should pass the translation phase unaltered. While these are typically device specific ACPI properties, they can also be specified to apply to a range of devices, or even all devices. On all systems with such regions Xen failed to prevent guests from undoing/replacing such mappings (CVE-2021-28694). On AMD systems, where a discontinuous range is specified by firmware, the supposedly-excluded middle range will also be identity-mapped (CVE-2021-28695). Further, on AMD systems, upon de-assigment of a physical device from a guest, the identity mappings would be left in place, allowing a guest continued access to ranges of memory which it shouldn't have access to anymore (CVE-2021-28696). |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:o:xen:xen:*:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:debian:debian_linux:11.0:*:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 6.8 | MEDIUM | 5.9 | 0.9 | CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H | 3.1 | PHYSICAL | LOW | NONE | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 4.6 | MEDIUM | 6.4 | 3.9 | AV:L/AC:L/Au:N/C:P/I:P/A:P | 2.0 | LOCAL | LOW | NONE | False | False | False | False | PARTIAL | PARTIAL | PARTIAL |

## Problem Type
NVD-CWE-Other

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://xenbits.xenproject.org/xsa/advisory-378.txt|https://xenbits.xenproject.org/xsa/advisory-378.txt|MISC|['Vendor Advisory']
[oss-security] 20210901 Xen Security Advisory 378 v3 (CVE-2021-28694,CVE-2021-28695,CVE-2021-28696) - IOMMU page mapping issues on x86|http://www.openwall.com/lists/oss-security/2021/09/01/1|MLIST|['Mailing List', 'Third Party Advisory']
[oss-security] 20210901 Re: Xen Security Advisory 378 v3 (CVE-2021-28694,CVE-2021-28695,CVE-2021-28696) - IOMMU page mapping issues on x86|http://www.openwall.com/lists/oss-security/2021/09/01/5|MLIST|['Mailing List', 'Third Party Advisory']
[oss-security] 20210901 Re: Xen Security Advisory 378 v3 (CVE-2021-28694,CVE-2021-28695,CVE-2021-28696) - IOMMU page mapping issues on x86|http://www.openwall.com/lists/oss-security/2021/09/01/6|MLIST|['Mailing List', 'Third Party Advisory']
FEDORA-2021-d68ed12e46|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/FZCNPSRPGFCQRYE2BI4D4Q4SCE56ANV2/|FEDORA|['Mailing List', 'Third Party Advisory']
FEDORA-2021-4f129cc0c1|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LPRVHW4J4ZCPPOHZEWP5MOJT7XDGFFPJ/|FEDORA|['Mailing List', 'Third Party Advisory']
DSA-4977|https://www.debian.org/security/2021/dsa-4977|DEBIAN|['Third Party Advisory']
FEDORA-2021-081f9bf5d2|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2VQCFAPBNGBBAOMJZG6QBREOG5IIDZID/|FEDORA|['Mailing List', 'Third Party Advisory']
GLSA-202208-23|https://security.gentoo.org/glsa/202208-23|GENTOO|['Third Party Advisory']
