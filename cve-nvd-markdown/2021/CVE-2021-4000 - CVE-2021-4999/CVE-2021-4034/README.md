# CVE-2021-4034


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-01-28 | 2022-10-25 | secalert@redhat.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | A local privilege escalation vulnerability was found on polkit's pkexec utility. The pkexec application is a setuid tool designed to allow unprivileged users to run commands as privileged users according predefined policies. The current version of pkexec doesn't handle the calling parameters count correctly and ends trying to execute environment variables as commands. An attacker can leverage this by crafting environment variables in such a way it'll induce pkexec to execute arbitrary code. When successfully executed the attack can cause a local privilege escalation given unprivileged users administrative rights on the target machine. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:polkit_project:polkit:*:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_desktop:7.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_workstation:7.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_for_scientific_computing:7.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server:7.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_for_power_little_endian:7.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server:6.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_for_power_big_endian:7.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_for_ibm_z_systems:7.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_aus:7.3:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_aus:7.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_tus:7.6:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_aus:7.6:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_aus:7.7:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_tus:7.7:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_eus:8.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_tus:8.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_aus:8.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_tus:8.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_aus:8.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_update_services_for_sap_solutions:8.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_update_services_for_sap_solutions:8.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_update_services_for_sap_solutions:8.1:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_for_power_little_endian_eus:8.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_for_ibm_z_systems_eus:8.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_for_power_little_endian_eus:8.1:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_for_power_little_endian:8.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_for_ibm_z_systems_eus:8.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_for_ibm_z_systems:8.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_for_power_little_endian_eus:8.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:redhat:enterprise_linux_server_eus:8.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:redhat:enterprise_linux_server_update_services_for_sap_solutions:7.7:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:redhat:enterprise_linux_server_update_services_for_sap_solutions:7.6:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:* | []     | OR |
| True  cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:esm:*:*:* | []     | OR |
| True  cpe:2.3:o:canonical:ubuntu_linux:20.04:*:*:*:lts:*:*:* | []     | OR |
| True  cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:esm:*:*:* | []     | OR |
| True  cpe:2.3:o:canonical:ubuntu_linux:21.10:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:suse:manager_server:4.1:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:suse:linux_enterprise_workstation_extension:12:sp5:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:suse:linux_enterprise_desktop:15:sp2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:suse:enterprise_storage:7.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:suse:manager_proxy:4.1:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:suse:linux_enterprise_high_performance_computing:15.0:sp2:*:*:-:*:*:* | []     | OR |
| True  cpe:2.3:o:suse:linux_enterprise_server:15:sp2:*:*:*:-:*:* | []     | OR |
| True  cpe:2.3:o:suse:linux_enterprise_server:15:sp2:*:*:*:sap:*:* | []     | OR |
| True  cpe:2.3:a:oracle:http_server:12.2.1.3.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:oracle:http_server:12.2.1.4.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:oracle:zfs_storage_appliance_kit:8.8:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:siemens:sinumerik_edge:*:*:*:*:*:*:*:* | []    3.3.0 | OR |
| True  cpe:2.3:a:starwindsoftware:starwind_virtual_san:v8:build14338:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:starwindsoftware:starwind_hyperconverged_appliance:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:starwindsoftware:command_center:1.0:update3_build5871:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.8 | HIGH | 5.9 | 1.8 | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H | 3.1 | LOCAL | LOW | LOW | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 7.2 | HIGH | 10.0 | 3.9 | AV:L/AC:L/Au:N/C:C/I:C/A:C | 2.0 | LOCAL | LOW | NONE | False | False | False | False | COMPLETE | COMPLETE | COMPLETE |

## Problem Type
CWE-787

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt|https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt|MISC|['Exploit', 'Mitigation', 'Third Party Advisory']
https://access.redhat.com/security/vulnerabilities/RHSB-2022-001|https://access.redhat.com/security/vulnerabilities/RHSB-2022-001|MISC|['Mitigation', 'Vendor Advisory']
https://bugzilla.redhat.com/show_bug.cgi?id=2025869|https://bugzilla.redhat.com/show_bug.cgi?id=2025869|MISC|['Issue Tracking', 'Patch', 'Vendor Advisory']
https://gitlab.freedesktop.org/polkit/polkit/-/commit/a2bf5c9c83b6ae46cbd5c779d3055bff81ded683|https://gitlab.freedesktop.org/polkit/polkit/-/commit/a2bf5c9c83b6ae46cbd5c779d3055bff81ded683|MISC|['Patch', 'Third Party Advisory']
http://packetstormsecurity.com/files/166196/Polkit-pkexec-Local-Privilege-Escalation.html|http://packetstormsecurity.com/files/166196/Polkit-pkexec-Local-Privilege-Escalation.html|MISC|['Exploit', 'Third Party Advisory', 'VDB Entry']
http://packetstormsecurity.com/files/166200/Polkit-pkexec-Privilege-Escalation.html|http://packetstormsecurity.com/files/166200/Polkit-pkexec-Privilege-Escalation.html|MISC|['Third Party Advisory', 'VDB Entry']
https://www.suse.com/support/kb/doc/?id=000020564|https://www.suse.com/support/kb/doc/?id=000020564|MISC|['Third Party Advisory']
https://www.oracle.com/security-alerts/cpuapr2022.html|https://www.oracle.com/security-alerts/cpuapr2022.html|MISC|['Third Party Advisory']
https://cert-portal.siemens.com/productcert/pdf/ssa-330556.pdf|https://cert-portal.siemens.com/productcert/pdf/ssa-330556.pdf|CONFIRM|['Third Party Advisory']
https://www.starwindsoftware.com/security/sw-20220818-0001/|https://www.starwindsoftware.com/security/sw-20220818-0001/|MISC|['Third Party Advisory']
