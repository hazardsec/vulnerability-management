# CVE-2021-32748


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-07-27 21:15:00 | 2021-08-09 20:54:00 | security-advisories@github.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | "Nextcloud Richdocuments in an open source self hosted online office. Nextcloud uses the WOPI (""Web Application Open Platform Interface"") protocol to communicate with the Collabora Editor, the communication between these two services was not protected by a credentials or IP check. Whilst this does not result in gaining access to data that the user has not yet access to, it can result in a bypass of any enforced watermark on documents as described on the [Nextcloud Virtual Data Room](https://nextcloud.com/virtual-data-room/) website and [our documentation](https://portal.nextcloud.com/article/nextcloud-and-virtual-data-room-configuration-59.html). The Nextcloud Richdocuments releases 3.8.3 and 4.2.0 add an additional admin settings for an allowlist of IP addresses that can access the WOPI API. We recommend upgrading and configuring the allowlist to a list of Collabora servers. There is no known workaround. Note that this primarily results a bypass of any configured watermark or download protection using File Access Control. If you do not require or rely on these as a security feature no immediate action is required on your end." |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:nextcloud:richdocuments:*:*:*:*:*:*:*:* | 4.0.0 | 4.2.0 | [] | OR |
| True | cpe:2.3:a:nextcloud:richdocuments:*:*:*:*:*:*:*:*  3.8.3 | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 4.3 | MEDIUM | 1.4 | 2.8 | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N | 3.1 | NETWORK | LOW | LOW | NONE | UNCHANGED | NONE | LOW | NONE |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 4.0 | MEDIUM | 2.9 | 8.0 | AV:N/AC:L/Au:S/C:N/I:P/A:N | 2.0 | NETWORK | LOW | SINGLE | 0 | False | False | False | NONE | PARTIAL | NONE |

## Problem Type
CWE-862

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/nextcloud/richdocuments/pull/1640|https://github.com/nextcloud/richdocuments/pull/1640|MISC|['Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://hackerone.com/reports/1194606|https://hackerone.com/reports/1194606|MISC|['Permissions Required']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/nextcloud/security-advisories/security/advisories/GHSA-24x8-h6m2-9jf2|https://github.com/nextcloud/security-advisories/security/advisories/GHSA-24x8-h6m2-9jf2|CONFIRM|['Third Party Advisory']
