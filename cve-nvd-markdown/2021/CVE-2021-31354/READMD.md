# CVE-2021-31354


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-10-19 19:15:00 | 2021-10-25 21:52:00 | sirt@juniper.net | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | An Out Of Bounds (OOB) access vulnerability in the handling of responses by a Juniper Agile License (JAL) Client in Juniper Networks Junos OS and Junos OS Evolved, configured in Network Mode (to use Juniper Agile License Manager) may allow an attacker to cause a partial Denial of Service (DoS), or lead to remote code execution (RCE). The vulnerability exists in the packet parsing logic on the client that processes the response from the server using a custom protocol. An attacker with control of a JAL License Manager, or with access to the local broadcast domain, may be able to spoof a new JAL License Manager and/or craft a response to the Junos OS License Client, leading to exploitation of this vulnerability. This issue only affects Junos systems configured in Network Mode. Systems that are configured in Standalone Mode (the default mode of operation for all systems) are not vulnerable to this issue. This issue affects: Juniper Networks Junos OS: 19.2 versions prior to 19.2R3-S3; 19.3 versions prior to 19.3R3-S3; 20.1 versions prior to 20.1R2-S2, 20.1R3-S1; 20.2 versions prior to 20.2R3-S2; 20.3 versions prior to 20.3R3; 20.4 versions prior to 20.4R3; 21.1 versions prior to 21.1R2. Juniper Networks Junos OS Evolved: version 20.1R1-EVO and later versions, prior to 21.2R2-EVO. This issue does not affect Juniper Networks Junos OS versions prior to 19.2R1. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:o:juniper:junos:19.2:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:r1-s2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:-:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:-:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:r1-s3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:r2-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:r1-s4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:r1-s5:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:r2-s2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:r2-s3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:r2-s4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:r2-s5:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.1:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.1:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.1:r1-s2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.1:r1-s3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.2:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.2:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.2:r1-s2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.1:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:r1-s6:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:r2-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:r3-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.2:r3-s2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:r3-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:19.3:r3-s2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.1:r1-s4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.1:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.1:r2-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.1:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.2:r1-s3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.2:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.2:r2-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.2:r2-s2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.2:r2-s3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.2:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.2:r3-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.3:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.3:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.3:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.3:r2-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.4:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.4:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.4:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:21.1:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.1:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.1:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.2:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.2:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.2:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.3:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.3:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:20.4:r2-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos:21.1:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.1:r2-s5:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.1:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.2:-:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.2:r2-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.2:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.3:-:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.3:r1-s3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r3-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.1:-:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.1:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.1:r1-s1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.1:r2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.2:r1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.2:r1-s1:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 8.8 | HIGH | 5.9 | 2.8 | CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H | 3.1 | ADJACENT_NETWORK | LOW | NONE | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 5.4 | MEDIUM | 6.4 | 5.5 | AV:A/AC:M/Au:N/C:P/I:P/A:P | 2.0 | ADJACENT_NETWORK | MEDIUM | NONE | 0 | False | False | False | PARTIAL | PARTIAL | PARTIAL |

## Problem Type
CWE-125

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://kb.juniper.net/JSA11219|https://kb.juniper.net/JSA11219|CONFIRM|['Vendor Advisory']
