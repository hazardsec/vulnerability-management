# CVE-2021-43616


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-11-13 | 2022-10-17 | cve@mitre.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | ** DISPUTED ** The npm ci command in npm 7.x and 8.x through 8.1.3 proceeds with an installation even if dependency information in package-lock.json differs from package.json. This behavior is inconsistent with the documentation, and makes it easier for attackers to install malware that was supposed to have been blocked by an exact version match requirement in package-lock.json. NOTE: The npm team believes this is not a vulnerability. It would require someone to socially engineer package.json which has different dependencies than package-lock.json. That user would have to have file system or write access to change dependencies. The npm team states preventing malicious actors from socially engineering or gaining file system access is outside the scope of the npm CLI. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:npmjs:npm:*:*:*:*:*:*:*:* | [] | 8.0.0 | 8.1.3   | OR |
| True  cpe:2.3:a:npmjs:npm:*:*:*:*:*:*:*:* | [] | 7.0.0 | 7.24.2   | OR |
| True  cpe:2.3:a:netapp:next_generation_application_programming_interface:-:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 9.8 | CRITICAL | 5.9 | 3.9 | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H | 3.1 | NETWORK | LOW | NONE | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 7.5 | HIGH | 6.4 | 10.0 | AV:N/AC:L/Au:N/C:P/I:P/A:P | 2.0 | NETWORK | LOW | NONE | False | False | False | False | PARTIAL | PARTIAL | PARTIAL |

## Problem Type
CWE-345

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://docs.npmjs.com/cli/v7/commands/npm-ci|https://docs.npmjs.com/cli/v7/commands/npm-ci|MISC|['Product', 'Vendor Advisory']
https://github.com/npm/cli/issues/2701|https://github.com/npm/cli/issues/2701|MISC|['Exploit', 'Issue Tracking', 'Third Party Advisory']
https://github.com/icatalina/CVE-2021-43616|https://github.com/icatalina/CVE-2021-43616|MISC|['Third Party Advisory']
https://medium.com/cider-sec/this-time-we-were-lucky-85c0dcac94a0|https://medium.com/cider-sec/this-time-we-were-lucky-85c0dcac94a0|MISC|['Exploit', 'Third Party Advisory']
https://security.netapp.com/advisory/ntap-20211210-0002/|https://security.netapp.com/advisory/ntap-20211210-0002/|CONFIRM|['Third Party Advisory']
https://github.com/npm/cli/commit/457e0ae61bbc55846f5af44afa4066921923490f|https://github.com/npm/cli/commit/457e0ae61bbc55846f5af44afa4066921923490f|CONFIRM|['Patch', 'Third Party Advisory']
FEDORA-2022-97b214b298|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/NXNVFKOF5ZYH5NIRWHKN6O6UBCHDV6FE/|FEDORA|['Mailing List', 'Third Party Advisory']
https://github.com/npm/cli/issues/2701#issuecomment-972900511|https://github.com/npm/cli/issues/2701#issuecomment-972900511|MISC|[]
https://docs.npmjs.com/cli/v8/commands/npm-ci|https://docs.npmjs.com/cli/v8/commands/npm-ci|MISC|[]
https://github.com/npm/cli/issues/2701#issuecomment-979054224|https://github.com/npm/cli/issues/2701#issuecomment-979054224|MISC|[]
