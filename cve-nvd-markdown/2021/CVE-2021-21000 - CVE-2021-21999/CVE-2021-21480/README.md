# CVE-2021-21480


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-03-09 | 2022-06-13 | cna@sap.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | SAP MII allows users to create dashboards and save them as JSP through the SSCE (Self Service Composition Environment). An attacker can intercept a request to the server, inject malicious JSP code in the request and forward to server. When this dashboard is opened by users having at least SAP_XMII Developer role, malicious content in the dashboard gets executed, leading to remote code execution in the server, which allows privilege escalation. The malicious JSP code can contain certain OS commands, through which an attacker can read sensitive files in the server, modify files or even delete contents in the server thus compromising the confidentiality, integrity and availability of the server hosting the SAP MII application. Also, an attacker authenticated as a developer can use the application to upload and execute a file which will permit them to execute operating systems commands completely compromising the server hosting the application. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:sap:manufacturing_integration_and_intelligence:15.1:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:sap:manufacturing_integration_and_intelligence:15.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:sap:manufacturing_integration_and_intelligence:15.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:sap:manufacturing_integration_and_intelligence:15.3:*:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 8.8 | HIGH | 5.9 | 2.8 | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H | 3.1 | NETWORK | LOW | LOW | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 9.0 | HIGH | 10.0 | 8.0 | AV:N/AC:L/Au:S/C:C/I:C/A:C | 2.0 | NETWORK | LOW | SINGLE | False | False | False | False | COMPLETE | COMPLETE | COMPLETE |

## Problem Type
CWE-94

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=571343107|https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=571343107|MISC|['Vendor Advisory']
https://launchpad.support.sap.com/#/notes/3022622|https://launchpad.support.sap.com/#/notes/3022622|MISC|['Permissions Required', 'Vendor Advisory']
20210614 Onapsis Security Advisory 2021-0012: SAP Manufacturing Integration and Intelligence lack of server side validations leads to RCE|http://seclists.org/fulldisclosure/2021/Jun/30|FULLDISC|['Mailing List', 'Third Party Advisory']
http://packetstormsecurity.com/files/163164/SAP-XMII-Remote-Code-Execution.html|http://packetstormsecurity.com/files/163164/SAP-XMII-Remote-Code-Execution.html|MISC|['Third Party Advisory', 'VDB Entry']
https://www.sap.com/documents/2022/02/fa865ea4-167e-0010-bca6-c68f7e60039b.html|https://www.sap.com/documents/2022/02/fa865ea4-167e-0010-bca6-c68f7e60039b.html|MISC|['Vendor Advisory']
