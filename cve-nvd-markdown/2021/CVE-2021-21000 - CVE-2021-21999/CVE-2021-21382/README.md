# CVE-2021-21382


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-06-11 | 2022-10-21 | security-advisories@github.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Restund is an open source NAT traversal server. The restund TURN server can be instructed to open a relay to the loopback address range. This allows you to reach any other service running on localhost which you might consider private. In the configuration that we ship (https://github.com/wireapp/ansible-restund/blob/master/templates/restund.conf.j2#L40-L43) the `status` interface of restund is enabled and is listening on `127.0.0.1`.The `status` interface allows users to issue administrative commands to `restund` like listing open relays or draining connections. It would be possible for an attacker to contact the status interface and issue administrative commands by setting `XOR-PEER-ADDRESS` to `127.0.0.1:{{restund_udp_status_port}}` when opening a TURN channel. We now explicitly disallow relaying to loopback addresses, 'any' addresses, link local addresses, and the broadcast address. As a workaround disable the `status` module in your restund configuration. However there might still be other services running on `127.0.0.0/8` that you do not want to have exposed. The `turn` module can be disabled. Restund will still perform STUN and this might already be enough for initiating calls in your environments. TURN is only used as a last resort when other NAT traversal options do not work. One should also make sure that the TURN server is set up with firewall rules so that it cannot relay to other addresses that you don't want the TURN server to relay to. For example other services in the same VPC where the TURN server is running. Ideally TURN servers should be deployed in an isolated fashion where they can only reach what they need to reach to perform their task of assisting NAT-traversal. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:wire:restund:*:*:*:*:*:*:*:* | []    0.4.15 | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 9.6 | CRITICAL | 5.8 | 3.1 | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N | 3.1 | NETWORK | LOW | LOW | NONE | CHANGED | HIGH | HIGH | NONE |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 5.5 | MEDIUM | 4.9 | 8.0 | AV:N/AC:L/Au:S/C:P/I:P/A:N | 2.0 | NETWORK | LOW | SINGLE | False | False | False | False | PARTIAL | PARTIAL | NONE |

## Problem Type
CWE-862

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/wireapp/ansible-restund/blob/master/templates/restund.conf.j2#L40-L43|https://github.com/wireapp/ansible-restund/blob/master/templates/restund.conf.j2#L40-L43|MISC|['Exploit', 'Third Party Advisory']
https://github.com/wireapp/restund/security/advisories/GHSA-96j5-w9jq-pv2x|https://github.com/wireapp/restund/security/advisories/GHSA-96j5-w9jq-pv2x|CONFIRM|['Exploit', 'Third Party Advisory']
https://www.rtcsec.com/post/2021/01/details-about-cve-2020-26262-bypass-of-coturns-default-access-control-protection/#further-concerns-what-else|https://www.rtcsec.com/post/2021/01/details-about-cve-2020-26262-bypass-of-coturns-default-access-control-protection/#further-concerns-what-else|MISC|['Not Applicable']
https://talosintelligence.com/vulnerability_reports/TALOS-2018-0732|https://talosintelligence.com/vulnerability_reports/TALOS-2018-0732|MISC|['Third Party Advisory', 'Exploit']
https://github.com/coturn/coturn/security/advisories/GHSA-6g6j-r9rf-cm7p|https://github.com/coturn/coturn/security/advisories/GHSA-6g6j-r9rf-cm7p|MISC|['Not Applicable']
https://github.com/wireapp/restund/pull/7|https://github.com/wireapp/restund/pull/7|MISC|['Exploit', 'Patch', 'Third Party Advisory']
https://docs.wire.com/understand/restund.html|https://docs.wire.com/understand/restund.html|MISC|['Vendor Advisory']
