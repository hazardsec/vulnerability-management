# CVE-2021-21380


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-03-23 23:15:00 | 2021-03-24 15:08:00 | security-advisories@github.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. In affected versions of XWiki Platform (and only those with the Ratings API installed), the Rating Script Service expose an API to perform SQL requests without escaping the from and where search arguments. This might lead to an SQL script injection quite easily for any user having Script rights on XWiki. The problem has been patched in XWiki 12.9RC1. The only workaround besides upgrading XWiki would be to uninstall the Ratings API in XWiki from the Extension Manager. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:xwiki:xwiki:6.4:rc1:*:*:*:*:*:* | []   | OR |
| True | cpe:2.3:a:xwiki:xwiki:6.4:-:*:*:*:*:*:* | []   | OR |
| True | cpe:2.3:a:xwiki:xwiki:6.4:milestone3:*:*:*:*:*:* | []   | OR |
| True | cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:* | [] | 6.4.1 | 12.8 | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 8.8 | HIGH | 5.9 | 2.8 | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H | 3.1 | NETWORK | LOW | LOW | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 6.5 | MEDIUM | 6.4 | 8.0 | AV:N/AC:L/Au:S/C:P/I:P/A:P | 2.0 | NETWORK | LOW | SINGLE | 0 | False | False | False | PARTIAL | PARTIAL | PARTIAL |

## Problem Type
CWE-89

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://jira.xwiki.org/browse/XWIKI-17662|https://jira.xwiki.org/browse/XWIKI-17662|MISC|['Issue Tracking', 'Vendor Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-79rg-7mv3-jrr5|https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-79rg-7mv3-jrr5|CONFIRM|['Third Party Advisory']
