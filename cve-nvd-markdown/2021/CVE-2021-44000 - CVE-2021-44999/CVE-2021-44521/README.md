# CVE-2021-44521


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2022-02-11 13:15:00 | 2022-08-09 00:39:00 | security@apache.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | When running Apache Cassandra with the following configuration: enable_user_defined_functions: true enable_scripted_user_defined_functions: true enable_user_defined_functions_threads: false it is possible for an attacker to execute arbitrary code on the host. The attacker would need to have enough permissions to create user defined functions in the cluster to be able to exploit this. Note that this configuration is documented as unsafe, and will continue to be considered unsafe after this CVE. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:apache:cassandra:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:cassandra:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:cassandra:*:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 9.1 | CRITICAL | 6.0 | 2.3 | CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H | 3.1 | NETWORK | LOW | HIGH | NONE | CHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 8.5 | HIGH | 10.0 | 6.8 | AV:N/AC:M/Au:S/C:C/I:C/A:C | 2.0 | NETWORK | MEDIUM | SINGLE | 0 | False | False | False | COMPLETE | COMPLETE | COMPLETE |

## Problem Type
CWE-732

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://lists.apache.org/thread/y4nb9s4co34j8hdfmrshyl09lokm7356|https://lists.apache.org/thread/y4nb9s4co34j8hdfmrshyl09lokm7356|MISC|['Issue Tracking', 'Mailing List', 'Vendor Advisory']
[oss-security] 20220211 CVE-2021-44521: Apache Cassandra: Remote code execution for scripted UDFs|http://www.openwall.com/lists/oss-security/2022/02/11/4|MLIST|['Mailing List', 'Third Party Advisory']
https://jfrog.com/blog/cve-2021-44521-exploiting-apache-cassandra-user-defined-functions-for-remote-code-execution/|https://jfrog.com/blog/cve-2021-44521-exploiting-apache-cassandra-user-defined-functions-for-remote-code-execution/|MISC|['Exploit', 'Mitigation', 'Third Party Advisory']
https://security.netapp.com/advisory/ntap-20220225-0001/|https://security.netapp.com/advisory/ntap-20220225-0001/|CONFIRM|['Third Party Advisory']
