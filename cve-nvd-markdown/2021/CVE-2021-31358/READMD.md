# CVE-2021-31358


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-10-19 19:15:00 | 2021-10-26 02:08:00 | sirt@juniper.net | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | A command injection vulnerability in sftp command processing on Juniper Networks Junos OS Evolved allows an attacker with authenticated CLI access to be able to bypass configured access protections to execute arbitrary shell commands within the context of the current user. The vulnerability allows an attacker to bypass command authorization restrictions assigned to their specific user account and execute commands that are available to the privilege level for which the user is assigned. For example, a user that is in the super-user login class, but restricted to executing specific CLI commands could exploit the vulnerability to execute any other command available to an unrestricted admin user. This vulnerability does not increase the privilege level of the user, but rather bypasses any CLI command restrictions by allowing full access to the shell. This issue affects Juniper Networks Junos OS Evolved: All versions prior to 20.4R2-S2-EVO; 21.1 versions prior to 21.1R2-EVO; 21.2 versions prior to 21.2R1-S1-EVO, 21.2R2-EVO. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r1:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.1:r1:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.1:r2:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.1:r1-s1:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.2:r1:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.2:r1-s1:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.2:r2:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:21.1:-:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s1:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:*:*:*:*:*:*:*:* | [] | 20.3 | OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r1-s2:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r2:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s1:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s2:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r2-s3:*:*:*:*:*:* | []  OR |
| True | cpe:2.3:o:juniper:junos_os_evolved:20.4:r3:*:*:*:*:*:* | []  OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.8 | HIGH | 5.9 | 1.8 | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H | 3.1 | LOCAL | LOW | LOW | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 7.2 | HIGH | 10.0 | 3.9 | AV:L/AC:L/Au:N/C:C/I:C/A:C | 2.0 | LOCAL | LOW | NONE | 0 | False | False | False | COMPLETE | COMPLETE | COMPLETE |

## Problem Type
CWE-77

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://kb.juniper.net/JSA11221|https://kb.juniper.net/JSA11221|CONFIRM|['Vendor Advisory']
