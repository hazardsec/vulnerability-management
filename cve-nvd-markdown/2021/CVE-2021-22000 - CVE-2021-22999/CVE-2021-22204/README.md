# CVE-2021-22204


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2021-04-23 18:15:00 | 2022-07-27 16:29:00 | cve@gitlab.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Improper neutralization of user data in the DjVu file format in ExifTool versions 7.44 and up allows arbitrary code execution when parsing the malicious image |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:exiftool_project:exiftool:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.8 | HIGH | 5.9 | 1.8 | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H | 3.1 | LOCAL | LOW | LOW | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 6.8 | MEDIUM | 6.4 | 8.6 | AV:N/AC:M/Au:N/C:P/I:P/A:P | 2.0 | NETWORK | MEDIUM | NONE | 1 | False | False | False | PARTIAL | PARTIAL | PARTIAL |

## Problem Type
CWE-74

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/exiftool/exiftool/commit/cf0f4e7dcd024ca99615bfd1102a841a25dde031#diff-fa0d652d10dbcd246e6b1df16c1e992931d3bb717a7e36157596b76bdadb3800|https://github.com/exiftool/exiftool/commit/cf0f4e7dcd024ca99615bfd1102a841a25dde031#diff-fa0d652d10dbcd246e6b1df16c1e992931d3bb717a7e36157596b76bdadb3800|MISC|['Patch', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://hackerone.com/reports/1154542|https://hackerone.com/reports/1154542|MISC|['Permissions Required', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-22204.json|https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-22204.json|CONFIRM|['Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
DSA-4910|https://www.debian.org/security/2021/dsa-4910|DEBIAN|['Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
FEDORA-2021-e3d8833d36|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DDKDLJLBTBBR66OOPXSXCG2PQRM5KCZL/|FEDORA|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
FEDORA-2021-de850ed71e|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/U4RF6PJCJ6NQOVJJJF6HN6BORUQVIXY6/|FEDORA|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
FEDORA-2021-88d24aa32b|https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/F6UOBPU3LSHAPRRJNISNVXZ5DSUIALLV/|FEDORA|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
[oss-security] 20210509 [CVE-2021-22204] ExifTool - Arbitrary code execution in the DjVu module when parsing a malicious image|http://www.openwall.com/lists/oss-security/2021/05/09/1|MLIST|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
[oss-security] 20210510 Re: [CVE-2021-22204] ExifTool - Arbitrary code execution in the DjVu module when parsing a malicious image|http://www.openwall.com/lists/oss-security/2021/05/10/5|MLIST|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
http://packetstormsecurity.com/files/162558/ExifTool-DjVu-ANT-Perl-Injection.html|http://packetstormsecurity.com/files/162558/ExifTool-DjVu-ANT-Perl-Injection.html|MISC|['Third Party Advisory', 'VDB Entry']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
[debian-lts-announce] 20210516 [SECURITY] [DLA 2663-1] libimage-exiftool-perl security update|https://lists.debian.org/debian-lts-announce/2021/05/msg00018.html|MLIST|['Mailing List', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
http://packetstormsecurity.com/files/164768/GitLab-Unauthenticated-Remote-ExifTool-Command-Injection.html|http://packetstormsecurity.com/files/164768/GitLab-Unauthenticated-Remote-ExifTool-Command-Injection.html|MISC|['Exploit', 'Third Party Advisory', 'VDB Entry']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
http://packetstormsecurity.com/files/164994/GitLab-13.10.2-Remote-Code-Execution.html|http://packetstormsecurity.com/files/164994/GitLab-13.10.2-Remote-Code-Execution.html|MISC|['Exploit', 'Third Party Advisory', 'VDB Entry']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
http://packetstormsecurity.com/files/167038/ExifTool-12.23-Arbitrary-Code-Execution.html|http://packetstormsecurity.com/files/167038/ExifTool-12.23-Arbitrary-Code-Execution.html|MISC|['Exploit', 'Third Party Advisory', 'VDB Entry']
