# CVE-2017-15705


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2018-09-17 14:29:00 | 2018-12-16 11:29:00 | security@apache.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | "A denial of service vulnerability was identified that exists in Apache SpamAssassin before 3.4.2. The vulnerability arises with certain unclosed tags in emails that cause markup to be handled incorrectly leading to scan timeouts. In Apache SpamAssassin, using HTML::Parser, we setup an object and hook into the begin and end tag event handlers In both cases, the ""open"" event is immediately followed by a ""close"" event - even if the tag *does not* close in the HTML being parsed. Because of this, we are missing the ""text"" event to deal with the object normally. This can cause carefully crafted emails that might take more scan time than expected leading to a Denial of Service. The issue is possibly a bug or design decision in HTML::Parser that specifically impacts the way Apache SpamAssassin uses the module with poorly formed html. The exploit has been seen in the wild but not believed to have been purposefully part of a Denial of Service attempt. We are concerned that there may be attempts to abuse the vulnerability in the future." |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:apache:spamassassin:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_desktop:7.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_workstation:7.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_server:7.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:* | [] | OR |
| True | cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:* | [] | OR |
| True | cpe:2.3:o:canonical:ubuntu_linux:12.04:*:*:*:esm:*:*:* | [] | OR |
| True | cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:* | [] | OR |
| True | cpe:2.3:o:redhat:enterprise_linux_eus:7.5:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 5.3 | MEDIUM | 1.4 | 3.9 | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L | 3.0 | NETWORK | LOW | NONE | NONE | UNCHANGED | NONE | NONE | LOW |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 5.0 | MEDIUM | 2.9 | 10.0 | AV:N/AC:L/Au:N/C:N/I:N/A:P | 2.0 | NETWORK | LOW | NONE | 0 | False | False | False | NONE | NONE | PARTIAL |

## Problem Type
CWE-20

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
[announce] 20180916 [SECURITY] Apache SpamAssassin 3.4.2 resolves CVE-2017-15705, CVE-2016-1238, CVE-2018-11780 & CVE-2018-11781|https://lists.apache.org/thread.html/7f6a16bc0fd0fd5e67c7fd95bd655069a2ac7d1f88e42d3c853e601c@%3Cannounce.apache.org%3E|MLIST|['Mailing List', 'Third Party Advisory']
105347|http://www.securityfocus.com/bid/105347|BID|['Third Party Advisory', 'VDB Entry']
RHSA-2018:2916|https://access.redhat.com/errata/RHSA-2018:2916|REDHAT|['Third Party Advisory']
USN-3811-1|https://usn.ubuntu.com/3811-1/|UBUNTU|['Third Party Advisory']
USN-3811-2|https://usn.ubuntu.com/3811-2/|UBUNTU|['Third Party Advisory']
[debian-lts-announce] 20181113 [SECURITY] [DLA 1578-1] spamassassin security update|https://lists.debian.org/debian-lts-announce/2018/11/msg00016.html|MLIST|['Third Party Advisory']
GLSA-201812-07|https://security.gentoo.org/glsa/201812-07|GENTOO|[]
openSUSE-SU-2019:1831|http://lists.opensuse.org/opensuse-security-announce/2019-08/msg00002.html|SUSE|[]
