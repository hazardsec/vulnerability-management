# CVE-2017-1000254


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2017-10-06 13:29:00 | 2021-06-29 15:15:00 | cve@mitre.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | libcurl may read outside of a heap allocated buffer when doing FTP. When libcurl connects to an FTP server and successfully logs in (anonymous or not), it asks the server for the current directory with the `PWD` command. The server then responds with a 257 response containing the path, inside double quotes. The returned path name is then kept by libcurl for subsequent uses. Due to a flaw in the string parser for this directory name, a directory name passed like this but without a closing double quote would lead to libcurl not adding a trailing NUL byte to the buffer holding the name. When libcurl would then later access the string, it could read beyond the allocated heap buffer and crash or wrongly access data beyond the buffer, thinking it was part of the path. A malicious server could abuse this fact and effectively prevent libcurl-based clients to work with it - the PWD command is always issued on new FTP connections and the mistake has a high chance of causing a segfault. The simple fact that this has issue remained undiscovered for this long could suggest that malformed PWD responses are rare in benign servers. We are not aware of any exploit of this flaw. This bug was introduced in commit [415d2e7cb7](https://github.com/curl/curl/commit/415d2e7cb7), March 2005. In libcurl version 7.56.0, the parser always zero terminates the string but also rejects it if not terminated properly with a final double quote. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:haxx:libcurl:7.9.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.9.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.19.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.19.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.8:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.9.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.7.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.21.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.11.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.7.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.12.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.40.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.17.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.19.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.23.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.30.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.8.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.37.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.26.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.33.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.12.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.18.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.21.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.25.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.16.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.19.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.36.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.9.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.10.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.12.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.14.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.41.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.15.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.15.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.17.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.19.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.9:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.10.8:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.13.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.13.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.16.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.16.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.18.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.19.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.20.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.21.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.27.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.34.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.7.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.10.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.10.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.42.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.15.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.24.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.31.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.9.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.10.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.11.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.15.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.21.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.22.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.28.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.35.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.10.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.55.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.54.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.50.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.48.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.49.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.21.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.23.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.29.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.9.8:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.10:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.10.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.52.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.53.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.44.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.45.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.37.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.50.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.50.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.16.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.21.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.9.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.12.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.55.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.52.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.51.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.43.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.49.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.15.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.42.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.15.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.18.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.19.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.21.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.32.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.9.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.10.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.11.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.13.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.14.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.53.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.54.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.46.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.47.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.47.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.38.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.39:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.50.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.16.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.19.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.20.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.21.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:haxx:libcurl:7.28.1:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.5 | HIGH | 3.6 | 3.9 | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H | 3.0 | NETWORK | LOW | NONE | NONE | UNCHANGED | NONE | NONE | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 5.0 | MEDIUM | 2.9 | 10.0 | AV:N/AC:L/Au:N/C:N/I:N/A:P | 2.0 | NETWORK | LOW | NONE | 0 | False | False | False | NONE | NONE | PARTIAL |

## Problem Type
CWE-119

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://curl.haxx.se/673d0cd8.patch|https://curl.haxx.se/673d0cd8.patch|CONFIRM|['Patch', 'Vendor Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
1039509|http://www.securitytracker.com/id/1039509|SECTRACK|['Third Party Advisory', 'VDB Entry']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
101115|http://www.securityfocus.com/bid/101115|BID|['Third Party Advisory', 'VDB Entry']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://curl.haxx.se/docs/adv_20171004.html|https://curl.haxx.se/docs/adv_20171004.html|CONFIRM|['Patch', 'Vendor Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
DSA-3992|http://www.debian.org/security/2017/dsa-3992|DEBIAN|[]
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
GLSA-201712-04|https://security.gentoo.org/glsa/201712-04|GENTOO|[]
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://support.apple.com/HT208331|https://support.apple.com/HT208331|CONFIRM|[]
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
RHSA-2018:2486|https://access.redhat.com/errata/RHSA-2018:2486|REDHAT|[]
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
RHSA-2018:3558|https://access.redhat.com/errata/RHSA-2018:3558|REDHAT|[]
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
[bookkeeper-issues] 20210628 [GitHub] [bookkeeper] padma81 opened a new issue #2746: Security Vulnerabilities in CentOS 7 image, Upgrade image to CentOS 8|https://lists.apache.org/thread.html/rf4c02775860db415b4955778a131c2795223f61cb8c6a450893651e4@%3Cissues.bookkeeper.apache.org%3E|MLIST|[]
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
[bookkeeper-issues] 20210629 [GitHub] [bookkeeper] padma81 opened a new issue #2746: Security Vulnerabilities in CentOS 7 image, Upgrade image to CentOS 8|https://lists.apache.org/thread.html/r58af02e294bd07f487e2c64ffc0a29b837db5600e33b6e698b9d696b@%3Cissues.bookkeeper.apache.org%3E|MLIST|[]
