# CVE-2017-9803


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2017-09-18 21:29:00 | 2019-03-08 16:56:00 | security@apache.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | Apache Solr's Kerberos plugin can be configured to use delegation tokens, which allows an application to reuse the authentication of an end-user or another application. There are two issues with this functionality (when using SecurityAwareZkACLProvider type of ACL provider e.g. SaslZkACLProvider). Firstly, access to the security configuration can be leaked to users other than the solr super user. Secondly, malicious users can exploit this leaked configuration for privilege escalation to further expose/modify private data and/or disrupt operations in the Solr cluster. The vulnerability is fixed from Apache Solr 6.6.1 onwards. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:apache:solr:6.2.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:solr:6.4.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:solr:6.2.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:solr:6.4.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:solr:6.5.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:solr:6.4.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:solr:6.5.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:solr:6.3.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:apache:solr:6.6.0:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.5 | HIGH | 5.9 | 1.6 | CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H | 3.0 | NETWORK | HIGH | LOW | NONE | UNCHANGED | HIGH | HIGH | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 6.0 | MEDIUM | 6.4 | 6.8 | AV:N/AC:M/Au:S/C:P/I:P/A:P | 2.0 | NETWORK | MEDIUM | SINGLE | 0 | False | False | False | PARTIAL | PARTIAL | PARTIAL |

## Problem Type
CWE-287

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
[www-announce] 20170918 CVE-2017-9803: Security vulnerability in kerberos delegation token functionality|http://mail-archives.us.apache.org/mod_mbox/www-announce/201709.mbox/%3CCAOOKt53AOScg04zUh0%2BR_fcXD0C9s5mQ-OzdgYdnHz49u1KmXw@mail.gmail.com%3E|MLIST|['Mailing List', 'Vendor Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
100870|http://www.securityfocus.com/bid/100870|BID|['Third Party Advisory', 'VDB Entry']
