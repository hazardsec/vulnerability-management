# CVE-2017-1000481


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2018-01-03 18:29:00 | 2018-01-18 22:47:00 | cve@mitre.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | When you visit a page where you need to login, Plone 2.5-5.1rc1 sends you to the login form with a 'came_from' parameter set to the previous url. After you login, you get redirected to the page you tried to view before. An attacker might try to abuse this by letting you click on a specially crafted link. You would login, and get redirected to the site of the attacker, letting you think that you are still on the original Plone site. Or some javascript of the attacker could be executed. Most of these types of attacks are already blocked by Plone, using the `isURLInPortal` check to make sure we only redirect to a page on the same Plone site. But a few more ways of tricking Plone into accepting a malicious link were discovered, and fixed with this hotfix. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:plone:plone:3.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.11:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.0.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.2.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0:rc2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.1.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:3.3.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:3.3.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.2.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.2.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.0.8:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.0.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.10:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.2.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.0.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.0.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:3.3.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0:rc3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.1:a1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.8:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.1.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.1.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.1.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:3.3.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:3.3.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0:rc1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.1:rc1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.14:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.2.6:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.0.9:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.1:b3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.1:a2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.12:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.2.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.1.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.0.3:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.0.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:3.3.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:2.5.5:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.1:b4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.1:b2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.9:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.4:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.2:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.2.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.1.1:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.0.10:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0.9:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0.8:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:5.0.7:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:plone:plone:4.3.15:*:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 6.1 | MEDIUM | 2.7 | 2.8 | CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N | 3.0 | NETWORK | LOW | NONE | REQUIRED | CHANGED | LOW | LOW | NONE |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 5.8 | MEDIUM | 4.9 | 8.6 | AV:N/AC:M/Au:N/C:P/I:P/A:N | 2.0 | NETWORK | MEDIUM | NONE | 1 | False | False | False | PARTIAL | PARTIAL | NONE |

## Problem Type
CWE-601

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://plone.org/security/hotfix/20171128/open-redirection-on-login-form|https://plone.org/security/hotfix/20171128/open-redirection-on-login-form|MISC|['Vendor Advisory']
