# CVE-2017-12425


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2017-08-04 | 2022-08-02 | cve@mitre.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | An issue was discovered in Varnish HTTP Cache 4.0.1 through 4.0.4, 4.1.0 through 4.1.7, 5.0.0, and 5.1.0 through 5.1.2. A wrong if statement in the varnishd source code means that particular invalid requests from the client can trigger an assert, related to an Integer Overflow. This causes the varnishd worker process to abort and restart, losing the cached contents in the process. An attacker can therefore crash the varnishd worker process on demand and effectively keep it from serving content - a Denial-of-Service attack. The specific source-code filename containing the incorrect statement varies across releases. |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:a:varnish-cache:varnish:4.0.3:rc-1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-cache:varnish:4.0.3:rc-2-proper:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-cache:varnish:4.0.3:rc-3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-cache:varnish:4.0.2:rc-1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-cache:varnish:4.0.3:rc-2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish_cache_project:varnish_cache:4.0.1:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish_cache_project:varnish_cache:4.0.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish_cache_project:varnish_cache:4.0.3:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish_cache_project:varnish_cache:4.0.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-cache:varnish:4.1.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.0:technology_preview1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.2:beta1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.1:beta2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.4:beta1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.0:beta1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.3:beta1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.5:beta2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.6:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.4:beta2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.4:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.5:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.2:beta2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.1:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.3:beta2:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.2:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.3:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.1:beta1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.4:beta3:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.5:beta1:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish-software:varnish_cache:4.1.7:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish_cache_project:varnish_cache:5.1.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish_cache_project:varnish_cache:5.0.0:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish_cache_project:varnish_cache:5.1.1:*:*:*:*:*:*:* | []     | OR |
| True  cpe:2.3:a:varnish_cache_project:varnish_cache:5.1.2:*:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 7.5 | HIGH | 3.6 | 3.9 | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H | 3.0 | NETWORK | LOW | NONE | NONE | UNCHANGED | NONE | NONE | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 5.0 | MEDIUM | 2.9 | 10.0 | AV:N/AC:L/Au:N/C:N/I:N/A:P | 2.0 | NETWORK | LOW | NONE | False | False | False | False | NONE | NONE | PARTIAL |

## Problem Type
CWE-190

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://www.varnish-cache.org/security/VSV00001.html#vsv00001|https://www.varnish-cache.org/security/VSV00001.html#vsv00001|CONFIRM|['Vendor Advisory']
https://lists.debian.org/debian-security-announce/2017/msg00186.html|https://lists.debian.org/debian-security-announce/2017/msg00186.html|CONFIRM|['Mailing List', 'Third Party Advisory']
https://github.com/varnishcache/varnish-cache/issues/2379|https://github.com/varnishcache/varnish-cache/issues/2379|CONFIRM|['Third Party Advisory']
https://bugzilla.suse.com/show_bug.cgi?id=1051917|https://bugzilla.suse.com/show_bug.cgi?id=1051917|CONFIRM|['Issue Tracking', 'Third Party Advisory']
https://bugzilla.redhat.com/show_bug.cgi?id=1477222|https://bugzilla.redhat.com/show_bug.cgi?id=1477222|CONFIRM|['Issue Tracking', 'Third Party Advisory']
DSA-3924|http://www.debian.org/security/2017/dsa-3924|DEBIAN|[]
