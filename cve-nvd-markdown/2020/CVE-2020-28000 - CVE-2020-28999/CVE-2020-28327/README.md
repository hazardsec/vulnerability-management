# CVE-2020-28327


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2020-11-06 19:15:00 | 2020-11-20 18:07:00 | cve@mitre.org | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | A res_pjsip_session crash was discovered in Asterisk Open Source 13.x before 13.37.1, 16.x before 16.14.1, 17.x before 17.8.1, and 18.x before 18.0.1. and Certified Asterisk before 16.8-cert5. Upon receiving a new SIP Invite, Asterisk did not return the created dialog locked or referenced. This caused a gap between the creation of the dialog object, and its next use by the thread that created it. Depending on some off-nominal circumstances and timing, it was possible for another thread to free said dialog in this gap. Asterisk could then crash when the dialog object, or any of its dependent objects, were dereferenced or accessed next by the initial-creation thread. Note, however, that this crash can only occur when using a connection-oriented protocol (e.g., TCP or TLS, but not UDP) for SIP transport. Also, the remote client must be authenticated, or Asterisk must be configured for anonymous calling. |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:asterisk:open_source:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:asterisk:open_source:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:asterisk:open_source:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:asterisk:open_source:*:*:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:cert1-rc1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:cert1-rc2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:cert1-rc3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:cert1-rc4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:cert2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:-:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:cert3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:cert4:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:cert4-rc1:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:cert4-rc2:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:cert4-rc3:*:*:*:*:*:* | [] | OR |
| True | cpe:2.3:a:digium:certified_asterisk:16.8:cert4-rc4:*:*:*:*:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 5.3 | MEDIUM | 3.6 | 1.6 | CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:H | 3.1 | NETWORK | HIGH | LOW | NONE | UNCHANGED | NONE | NONE | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 2.1 | LOW | 2.9 | 3.9 | AV:N/AC:H/Au:S/C:N/I:N/A:P | 2.0 | NETWORK | HIGH | SINGLE | 0 | False | False | False | NONE | NONE | PARTIAL |

## Problem Type
CWE-404

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
http://downloads.asterisk.org/pub/security/AST-2020-001.html|http://downloads.asterisk.org/pub/security/AST-2020-001.html|MISC|['Patch', 'Vendor Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://issues.asterisk.org/jira/browse/ASTERISK-29057|https://issues.asterisk.org/jira/browse/ASTERISK-29057|MISC|['Exploit', 'Issue Tracking', 'Vendor Advisory']
