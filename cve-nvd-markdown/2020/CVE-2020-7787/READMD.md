# CVE-2020-7787


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2020-12-09 17:15:00 | 2020-12-11 17:01:00 | report@snyk.io | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | "This affects all versions of package react-adal. It is possible for a specially crafted JWT token and request URL can cause the nonce, session and refresh values to be incorrectly validated, causing the application to treat an attacker-generated JWT token as authentic. The logical defect is caused by how the nonce, session and refresh values are stored in the browser local storage or session storage. Each key is automatically appended by   . When the received nonce and session keys are generated, the list of values is stored in the browser storage, separated by   , with    always appended to the end of the list. Since    will always be the last 2 characters of the stored values, an empty string ("""") will always be in the list of the valid values. Therefore, if an empty session parameter is provided in the callback URL, and a specially-crafted JWT token contains an nonce value of """" (empty string), then adal.js will consider the JWT token as authentic." |

## Configurations
| Vulnerable | CPE 23 URI | CPE Name | Operator |
| ---------- | ---------- | -------- | -------- |
| True | cpe:2.3:a:react-adal_project:react-adal:*:*:*:*:*:node.js:*:* | [] | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 8.2 | HIGH | 4.2 | 3.9 | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N | 3.1 | NETWORK | LOW | NONE | NONE | UNCHANGED | HIGH | LOW | NONE |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 5.0 | MEDIUM | 2.9 | 10.0 | AV:N/AC:L/Au:N/C:N/I:P/A:N | 2.0 | NETWORK | LOW | NONE | 0 | False | False | False | NONE | PARTIAL | NONE |

## Problem Type
CWE-287

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://snyk.io/vuln/SNYK-JS-REACTADAL-1018907|https://snyk.io/vuln/SNYK-JS-REACTADAL-1018907|MISC|['Exploit', 'Third Party Advisory']
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
https://github.com/salvoravida/react-adal/pull/115|https://github.com/salvoravida/react-adal/pull/115|MISC|['Exploit', 'Third Party Advisory']
