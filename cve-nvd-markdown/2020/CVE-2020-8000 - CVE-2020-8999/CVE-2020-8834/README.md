# CVE-2020-8834


## Metadata
| Published | Last Modified | Assigner | Version | Format |
| --------- | ------------- | -------- | ------- | ------ |
| 2020-04-09 | 2022-10-07 | security@ubuntu.com | 4.0 | MITRE | 

## Description
| Language | Description |
| -------- | ----------- |
| en | "KVM in the Linux kernel on Power8 processors has a conflicting use of HSTATE_HOST_R1 to store r1 state in kvmppc_hv_entry plus in kvmppc_{save,restore}_tm, leading to a stack corruption. Because of this, an attacker with the ability run code in kernel space of a guest VM can cause the host kernel to panic. There were two commits that, according to the reporter, introduced the vulnerability: f024ee098476 (""KVM: PPC: Book3S HV: Pull out TM state save/restore into separate procedures"") 87a11bb6a7f7 (""KVM: PPC: Book3S HV: Work around XER[SO] bug in fake suspend mode"") The former landed in 4.8, the latter in 4.17. This was fixed without realizing the impact in 4.18 with the following three commits, though it's believed the first is the only strictly necessary commit: 6f597c6b63b6 (""KVM: PPC: Book3S PR: Add guest MSR parameter for kvmppc_save_tm()/kvmppc_restore_tm()"") 7b0e827c6970 (""KVM: PPC: Book3S HV: Factor fake-suspend handling out of kvmppc_save/restore_tm"") 009c872a8bc4 (""KVM: PPC: Book3S PR: Move kvmppc_save_tm/kvmppc_restore_tm to separate file"")" |

## Configurations
| Vulnerable | CPE 22 URI | CPE 23 URI | CPE Name | Version Start Including | Version End Including | Version Start Excluding | Version End Excluding | Operator |
| ---------- | ---------- | ---------- | -------- | ----------------------- | --------------------- | ----------------------- | --------------------- | -------- |
| True  cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:* | []     | OR |
| True  cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:* | []     | OR |
| True  cpe:2.3:o:opensuse:leap:15.1:*:*:*:*:*:*:* | []     | OR |

## CVSSv3 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Attack Vector | Attack Complexity | Privileges Required | User Interaction | Scope | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | ------------------- | ---------------- | ----- | ---------------------- | ---------------- | ------------------- |
| 6.5 | MEDIUM | 4.0 | 2.0 | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H | 3.1 | LOCAL | LOW | LOW | NONE | CHANGED | NONE | NONE | HIGH |

## CVSSv2 Information
| Score | Severity | Impact Score | Exploitability Score | Vector String | Version | Access Vector | Access Complexity | Authentication | User Interaction Required | Obtain All Privilge | Obtain User Privilege | Obtain Other Privilege | Confidentiality Impact | Integrity Impact | Availability Impact |
| ----- | -------- | ------------ | -------------------- | ------------- | ------- | ------------- | ----------------- | -------------- | ------------------------- | ------------------- | --------------------- | ---------------------- | ---------------------- | ---------------- | ------------------- |
| 4.9 | MEDIUM | 6.9 | 3.9 | AV:L/AC:L/Au:N/C:N/I:N/A:C | 2.0 | LOCAL | LOW | NONE | False | False | False | False | NONE | NONE | COMPLETE |

## Problem Type
CWE-362

## References
| Name | Reference URL | Reference Source | Tags |
| ---- | ------------- | ---------------- | ---- |
N/A|https://www.openwall.com/lists/oss-security/2020/04/06/2|CONFIRM|['Mailing List', 'Third Party Advisory']
N/A|https://usn.ubuntu.com/usn/usn-4318-1|UBUNTU|['Third Party Advisory']
N/A|https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1867717|CONFIRM|['Exploit', 'Third Party Advisory']
USN-4318-1|https://usn.ubuntu.com/4318-1/|UBUNTU|['Third Party Advisory']
openSUSE-SU-2020:0543|http://lists.opensuse.org/opensuse-security-announce/2020-04/msg00035.html|SUSE|['Mailing List', 'Third Party Advisory']
